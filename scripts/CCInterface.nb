(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    170172,       3819]
NotebookOptionsPosition[    157214,       3599]
NotebookOutlinePosition[    157547,       3614]
CellTagsIndexPosition[    157504,       3611]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["CoffeeCode Mathematica", "Title",ExpressionUUID->"05f2f0b3-248f-446b-818d-71c44321d439"],

Cell["\<\
CoffeeCode Mathematica Interface, \[Copyright] 2019 Johannes Bausch
For joint Graph State project with Felix Leditzky\
\>", "Text",ExpressionUUID->"072f76c1-fb95-4210-bd41-ba7ec3a3e0dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["CoffeeCode Interface", "Chapter"]], "Title",ExpressionUUID->"71f171ba-05e0-4ee3-a92c-268f76af182b"],

Cell[CellGroupData[{

Cell[TextData[{
 "Setup",
 StyleBox[" [Build paths to be fixed here; contains more instructions]", 
  "Subtitle"]
}], "Section",ExpressionUUID->"57c69716-11b6-4909-8c06-b8034e735387"],

Cell[TextData[{
 "Set the CoffeeCode release path below (where you execute ",
 StyleBox["make", "Code"],
 "), and the file you configured as cc-instance-custom.h during ",
 StyleBox["ccmake", "Code"],
 ". You can use the file open dialogue helper to obtain said paths.\n\nNote \
that depending on whether the build directory is set up with ",
 StyleBox["SYMMETRIC_SOLVER", "Code"],
 " or not will ",
 StyleBox["NOT", "Code"],
 " determine what variant of CoffeeCode is used to execute the instance; you \
have to do this manually. Also note that the output will be wrong for general \
channels if ",
 StyleBox["OPTIMIZE_FOR_DEPOLARIZING", "Code"],
 " is set as build flag.\n\nFinally, you\[CloseCurlyQuote]ll have to edit ",
 StyleBox["scripts/make-build-dir.sh", "Code"],
 " to activate a valid conda environment for building with a modern gcc. You \
can remove all the source... blabla lines there if the compilation \
environment is installed globally anyhow."
}], "Text",ExpressionUUID->"6d0b087b-bf21-4171-9beb-a1a58809c314"],

Cell[BoxData[{
 RowBox[{"SystemDialogInput", "[", "\"\<Directory\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SystemDialogInput", "[", "\"\<FileOpen\>\"", "]"}]}], "Input",Expres\
sionUUID->"f143b4f4-d59f-40e2-b07b-9f6d037609a9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
   "CCRELEASEPATHFULLSOLVER", "=", 
    "\"\</home/jkrb2/programming/CoffeeCode/build/release_full/\>\""}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "RESULTSPATH", "=", "\"\</home/jkrb2/Desktop/GraphStateResults/\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "PARALLELBUILDPATH", "=", 
   "\"\</home/jkrb2/programming/CoffeeCode/build/\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "PARALLELBUILDSETUPSCRIPT", "=", 
   "\"\</home/jkrb2/programming/CoffeeCode/scripts/make-build-dir.sh\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CCCUSTOMINSTANCEFILE", "=", "\"\<cc-instance-custom.h\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[1]:=",ExpressionUUID->"2bd927cd-d961-400d-84a7-a994bf02098a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Assert", "[", "On", "]"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "enable", " ", "sanity", " ", "checks", " ", "instead", " ", "of", " ", 
    "failing", " ", "silently"}], " ", "*)"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[6]:=",ExpressionUUID->"f4c5d28e-c768-4297-bd53-7f6008aaf1cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "avoid", " ", "race", " ", "conditions", " ", "when", " ", "building", " ",
     "in", " ", "parallel"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", "ParallelBuildDirectory", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ParallelBuildDirectory", "[", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"targetFolder", "=", 
        RowBox[{"PARALLELBUILDPATH", "<>", "\"\<release-\>\"", "<>", 
         RowBox[{"ToString", "@", "$SessionID"}], "<>", "\"\<.\>\"", "<>", 
         RowBox[{"ToString", "@", "$KernelID"}], "<>", "\"\</\>\""}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"DirectoryQ", "[", "targetFolder", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Echo", "[", 
           RowBox[{
           "\"\<setting up parallel build directory: \>\"", "<>", 
            "targetFolder"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"RunProcess", "[", 
           RowBox[{"{", 
            RowBox[{"PARALLELBUILDSETUPSCRIPT", ",", "targetFolder"}], "}"}], 
           "]"}]}]}], " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "bug", " ", "with", " ", "commands", " ", "like", " ", 
          "\"\<source\>\""}], " ", "*)"}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "targetFolder"}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[7]:=",ExpressionUUID->"8ac5bc65-e58d-4573-ad62-458de7d600e0"],

Cell[BoxData[
 RowBox[{"ParallelBuildDirectory", "[", "]"}]], "Input",ExpressionUUID->"5414ea6a-4452-4afe-accc-1ead774180cf"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Basic Graph Functionality",
 StyleBox[" [install IGraphM once below, then forget]", "Subtitle"]
}], "Section",ExpressionUUID->"24de59ba-d762-45f7-a221-69fee8b0182e"],

Cell[CellGroupData[{

Cell["IGraphM", "Subsection",ExpressionUUID->"4b3fd279-ccbd-487a-bf98-22c6f8a68bcb"],

Cell["\<\
Uncomment the last line in the following cell, then execute to install \
IGraphM. This only has to be done once per machine.\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"b1acc837-e21d-4664-ac78-39dcc027a8eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"updateIGraphM", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"json", ",", "download", ",", "target", ",", "msg"}], "}"}], 
     ",", 
     RowBox[{
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"json", "=", 
          RowBox[{"Import", "[", 
           RowBox[{
           "\"\<https://api.github.com/repos/szhorvat/IGraphM/releases\>\"", 
            ",", "\"\<JSON\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"download", "=", 
          RowBox[{"Lookup", "[", 
           RowBox[{
            RowBox[{"First", "@", 
             RowBox[{"Lookup", "[", 
              RowBox[{
               RowBox[{"First", "[", "json", "]"}], ",", "\"\<assets\>\""}], 
              "]"}]}], ",", "\"\<browser_download_url\>\""}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"msg", "=", 
          RowBox[{"\"\<Downloading IGraph/M \>\"", "<>", 
           RowBox[{"Lookup", "[", 
            RowBox[{
             RowBox[{"First", "[", "json", "]"}], ",", "\"\<tag_name\>\""}], 
            "]"}], "<>", "\"\< ...\>\""}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"target", "=", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"CreateDirectory", "[", "]"}], ",", 
             "\"\<IGraphM.paclet\>\""}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"$Notebooks", ",", 
           RowBox[{"PrintTemporary", "@", 
            RowBox[{"Labeled", "[", 
             RowBox[{
              RowBox[{"ProgressIndicator", "[", 
               RowBox[{"Appearance", "\[Rule]", "\"\<Necklace\>\""}], "]"}], 
              ",", "msg", ",", "Right"}], "]"}]}], ",", 
           RowBox[{"Print", "[", "msg", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"URLSave", "[", 
          RowBox[{"download", ",", "target"}], "]"}]}], ",", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FileExistsQ", "[", "target", "]"}], ",", 
        RowBox[{"PacletManager`PacletInstall", "[", "target", "]"}], ",", 
        "$Failed"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"updateIGraphM", "[", "]"}], "*)"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "uncomment", " ", "this", " ", "once", " ", "and", " ", "run", " ", "to", 
     " ", "install", " ", "IGraphM", " ", "locally"}], ",", " ", 
    RowBox[{"then", " ", "comment", " ", "again"}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}]], "Input",ExpressionUUID->"131ef900-dec3-4b81-a212-\
609c51d8a7fe"],

Cell[BoxData[{
 RowBox[{"<<", "IGraphM`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", 
   RowBox[{
    RowBox[{"<<", "IGraphM`"}], ";"}], "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[9]:=",ExpressionUUID->"b9136ea9-e8dd-4b4d-a407-c36b6caee0e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Group for Graph State", "Subsection",ExpressionUUID->"adad04a3-eb52-40f0-98af-dcab146de618"],

Cell["\<\
GroupForGraph gives the full automorphism group of the underlying graph; we \
color the environment vertices in a different color to make sure the \
permutation group will be a product across this partitioning.\
\>", "Text",ExpressionUUID->"e09c34e0-ed88-4615-8990-033ee7fef50f"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "GroupForGraph", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GroupForGraph", "[", 
   RowBox[{"graph_Graph", ",", "kSys_Integer", ",", 
    RowBox[{"extraStabilizedVertices_List:", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"GroupForGraph", "[", 
    RowBox[{"graph", ",", "kSys", ",", "extraStabilizedVertices"}], "]"}], 
   "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kTot", "=", 
        RowBox[{"VertexCount", "@", "graph"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "11"}], "}"}], " ", "for", " ", "a", 
         " ", "graph", " ", "of", " ", "size", " ", "14", " ", "would", " ", 
         "be", " ", "mapped", " ", "to", " ", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "0", ",", "2", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "3", ",", "0", ",", "0", ",", 
           "0"}], "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"extraColors", "=", 
        RowBox[{"Normal", "@", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"extraStabilizedVertices", "\[Rule]", 
             RowBox[{"Range", "@", 
              RowBox[{"Length", "@", "extraStabilizedVertices"}]}]}], "]"}], 
           ",", 
           RowBox[{"VertexCount", "@", "graph"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PermutationGroup", "[", "\[IndentingNewLine]", 
      RowBox[{"PermutationCycles", "/@", 
       RowBox[{"IGBlissAutomorphismGroup", "[", 
        RowBox[{"{", 
         RowBox[{"graph", ",", 
          RowBox[{"\"\<VertexColors\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", "kSys"}], "]"}], "~", "Join", "~", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               SuperscriptBox["kTot", "2"], ",", 
               RowBox[{"kTot", "-", "kSys"}]}], "]"}]}], "+", 
            "extraColors"}]}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[11]:=",ExpressionUUID->"75fdcb38-966c-413a-b727-ed354caaa6f9"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"for", " ", "iterating", " ", "over", " ", "tuples"}], ",", " ", 
   RowBox[{
    RowBox[{"we", "'"}], "ll", " ", "only", " ", "need", " ", "the", " ", 
    "system", " ", "vertices", " ", "subgroup"}], ",", " ", 
   RowBox[{"not", " ", "the", " ", "full", " ", "group"}]}], " ", 
  "*)"}]], "Input",ExpressionUUID->"172b24de-bcf5-43b8-84d5-95d7ac800159"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "Subgroup", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Subgroup", "[", 
   RowBox[{"group_PermutationGroup", ",", "kSys_Integer"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Subgroup", "[", 
    RowBox[{"group", ",", "kSys"}], "]"}], "=", 
   RowBox[{
    RowBox[{"group", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p_Integer", "/;", 
        RowBox[{"p", ">", "kSys"}]}], "\[Rule]", "Nothing"}], "}"}]}], "/.", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", "}"}], "]"}], "\[Rule]", "Nothing"}]}]}]}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[13]:=",ExpressionUUID->"bc589834-9193-4d13-9f58-0cc97a2ae374"]
}, Closed]],

Cell["Plot Environment Vertices in Red", "Subsection",ExpressionUUID->"aa5aa6ad-e4c7-4477-8c78-d8d40945c86d"],

Cell[CellGroupData[{

Cell["Create all Possible Choices of Hairs to the Environment", "Subsection",ExpressionUUID->"a5a64d42-5c65-4c4f-b7a6-241f554b760b"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"IsomorphicHairChoiceQ", ",", "HairColoring"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HairColoring", "[", "hairs_", "]"}], ":=", 
  RowBox[{
   RowBox[{"HairColoring", "[", 
    RowBox[{"Sort", "@", "hairs"}], "]"}], "=", 
   RowBox[{"Length", "/@", 
    RowBox[{"GroupBy", "[", 
     RowBox[{"hairs", ",", "Identity"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IsomorphicHairChoiceQ", "[", 
   RowBox[{"g_Graph", ",", "hairs1_", ",", "hairs2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"IsomorphicHairChoiceQ", "[", 
    RowBox[{"g", ",", "hairs1", ",", "hairs2"}], "]"}], "=", 
   RowBox[{
    RowBox[{"IsomorphicHairChoiceQ", "[", 
     RowBox[{"g", ",", "hairs2", ",", "hairs1"}], "]"}], "=", 
    RowBox[{"IGBlissIsomorphicQ", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"g", ",", 
        RowBox[{"\"\<VertexColors\>\"", "\[Rule]", 
         RowBox[{"HairColoring", "@", "hairs1"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"g", ",", 
        RowBox[{"\"\<VertexColors\>\"", "\[Rule]", 
         RowBox[{"HairColoring", "@", "hairs2"}]}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IsomorphicHairChoiceQ", "[", "g_Graph", "]"}], ":=", 
  RowBox[{
   RowBox[{"IsomorphicHairChoiceQ", "[", 
    RowBox[{"g", ",", "#1", ",", "#2"}], "]"}], "&"}]}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[17]:=",ExpressionUUID->"ce1ba3f2-6195-4bf4-b2c8-dd12b0cb69ef"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"HairGraph", ",", "AllHairGraphs"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HairGraph", "[", 
   RowBox[{"g_Graph", ",", "hairs_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"HairGraph", "[", 
    RowBox[{"g", ",", "hairs"}], "]"}], "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"new", "=", 
       RowBox[{
        RowBox[{"VertexCount", "@", "g"}], "+", 
        RowBox[{"Range", "@", 
         RowBox[{"Length", "@", "hairs"}]}]}]}], "\[IndentingNewLine]", "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"EdgeList", "[", "g", "]"}], "~", "Join", "~", 
       RowBox[{"Thread", "[", 
        RowBox[{"hairs", "\[UndirectedEdge]", "new"}], "]"}]}], "//", 
      "Graph"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllHairGraphs", "[", 
   RowBox[{"g_Graph", ",", 
    RowBox[{"generator_:", 
     RowBox[{"Hold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Subsets", "[", "#", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], "&"}], "]"}]}]}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"AllHairGraphs", "[", 
    RowBox[{"g", ",", "generator"}], "]"}], "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "first", " ", "check", " ", "for", " ", "graph", " ", "isomorphism", 
        " ", "using", " ", "a", " ", "vertex", " ", "coloring"}], " ", "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"uniqueHairEndpoints", "=", 
       RowBox[{"DeleteDuplicates", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ReleaseHold", "[", "generator", "]"}], "[", 
          RowBox[{"VertexList", "@", "g"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"IsomorphicHairChoiceQ", "[", "g", "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"EnvironmentPlot", "[", 
        RowBox[{
         RowBox[{"HairGraph", "[", 
          RowBox[{"g", ",", "#"}], "]"}], ",", 
         RowBox[{"VertexCount", "@", "g"}]}], "]"}], "&"}], "/@", 
      "uniqueHairEndpoints"}]}], "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[21]:=",ExpressionUUID->"4043caca-c9e6-4af6-9a20-764068b4ae73"],

Cell[BoxData[
 RowBox[{"AllHairGraphs", "[", 
  RowBox[{
   GraphicsBox[
    NamespaceBox["NetworkGraphics",
     DynamicModuleBox[{Typeset`graph = HoldComplete[
       Graph[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 
        19}, {Null, {{1, 2}, {1, 3}, {1, 4}, {1, 5}, {1, 6}, {1, 7}, {1, 8}, {
         1, 9}, {1, 10}, {1, 11}, {1, 12}, {1, 13}, {1, 14}, {1, 15}, {1, 
         16}, {2, 17}, {2, 18}, {2, 19}}}]]}, 
      TagBox[GraphicsGroupBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQBmIQ7ZVx+01N1H97CH0fSp9HoxHi5n1LNt5tfo4m/x7O
11PkFOmb8RlN/Xc43/G3vb9u/m80/f/h/FVZ1q7PFjE6oJrHDOdvvn7tkWkf
qwOq+exw/h6XoobWSk4HVPu44fyjG3nlrqbwwvkMaABdHOZ/GB8A6DGMzg==

         "], {
          {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
           {Arrowheads[0.], ArrowBox[{1, 2}, 0.03488701549084065]}, 
           {Arrowheads[0.], ArrowBox[{1, 3}, 0.03488701549084065]}, 
           {Arrowheads[0.], ArrowBox[{1, 4}, 0.03488701549084065]}, 
           {Arrowheads[0.], ArrowBox[{1, 5}, 0.03488701549084065]}, 
           {Arrowheads[0.], ArrowBox[{1, 6}, 0.03488701549084065]}, 
           {Arrowheads[0.], ArrowBox[{1, 7}, 0.03488701549084065]}, 
           {Arrowheads[0.], ArrowBox[{1, 8}, 0.03488701549084065]}, 
           {Arrowheads[0.], ArrowBox[{1, 9}, 0.03488701549084065]}, 
           {Arrowheads[0.], ArrowBox[{1, 10}, 0.03488701549084065]}, 
           {Arrowheads[0.], ArrowBox[{1, 11}, 0.03488701549084065]}, 
           {Arrowheads[0.], ArrowBox[{1, 12}, 0.03488701549084065]}, 
           {Arrowheads[0.], ArrowBox[{1, 13}, 0.03488701549084065]}, 
           {Arrowheads[0.], ArrowBox[{1, 14}, 0.03488701549084065]}, 
           {Arrowheads[0.], ArrowBox[{1, 15}, 0.03488701549084065]}, 
           {Arrowheads[0.], ArrowBox[{1, 16}, 0.03488701549084065]}, 
           {Arrowheads[0.], ArrowBox[{2, 17}, 0.03488701549084065]}, 
           {Arrowheads[0.], ArrowBox[{2, 18}, 0.03488701549084065]}, 
           {Arrowheads[0.], ArrowBox[{2, 19}, 0.03488701549084065]}}, 
          {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
           DiskBox[1, 0.03488701549084065], DiskBox[2, 0.03488701549084065], 
           DiskBox[3, 0.03488701549084065], DiskBox[4, 0.03488701549084065], 
           DiskBox[5, 0.03488701549084065], DiskBox[6, 0.03488701549084065], 
           DiskBox[7, 0.03488701549084065], DiskBox[8, 0.03488701549084065], 
           DiskBox[9, 0.03488701549084065], DiskBox[10, 0.03488701549084065], 
           DiskBox[11, 0.03488701549084065], DiskBox[12, 0.03488701549084065],
            DiskBox[13, 0.03488701549084065], 
           DiskBox[14, 0.03488701549084065], DiskBox[15, 0.03488701549084065],
            DiskBox[16, 0.03488701549084065], 
           DiskBox[17, 0.03488701549084065], DiskBox[18, 0.03488701549084065],
            DiskBox[19, 0.03488701549084065]}}]],
       MouseAppearanceTag["NetworkGraphics"]],
      AllowKernelInitialization->False]],
    DefaultBaseStyle->{
     "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
    FormatType->TraditionalForm,
    FrameTicks->None,
    ImageSize->{296., Automatic}], ",", 
   RowBox[{
    RowBox[{"Subsets", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "&"}]}], "]"}]], "Input",ExpressionUUI\
D->"fad12075-2f16-40bd-a5f9-47919faf42f0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Strong Generating Set Transversal", "Subsection",ExpressionUUID->"d3d25f39-62f4-4d18-9123-6a482ac8696d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "SGSTransversal", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "the", " ", "head", " ", "element", " ", "of", " ", "the", " ", "group", 
    " ", "stabilizer", " ", "chain", " ", "already", " ", "delivers", " ", 
    "a", " ", "transversal", " ", "of", " ", "a", " ", "strong", " ", 
    "generating", " ", "set"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SGSTransversal", "[", "group_PermutationGroup", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"chain", "=", 
      RowBox[{"GroupStabilizerChain", "[", "group", "]"}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Partition", "[", 
       RowBox[{"chain", ",", "2", ",", "1"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{"sA_", ",", "gA_"}], "]"}], ",", 
         RowBox[{"Rule", "[", 
          RowBox[{"sB_", ",", "gB_"}], "]"}]}], "}"}], "\[RuleDelayed]", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Complement", "[", 
          RowBox[{"sB", ",", "sA"}], "]"}], "\[Rule]", 
         RowBox[{"PermutationGroup", "@", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"GroupGenerators", "@", "gA"}], ",", 
            RowBox[{"GroupGenerators", "@", "gB"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", ")"}]}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Rule", "[", 
        RowBox[{"s_", ",", 
         RowBox[{"PermutationGroup", "[", 
          RowBox[{"{", "}"}], "]"}]}], "]"}], "\[RuleDelayed]", "Nothing"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[24]:=",ExpressionUUID->"7fa11aa9-bd2f-4013-a843-2475e21e26cd"],

Cell[BoxData[
 RowBox[{"SGSTransversal", "[", 
  RowBox[{"GroupForGraph", "[", 
   RowBox[{
    GraphicsBox[
     NamespaceBox["NetworkGraphics",
      DynamicModuleBox[{Typeset`graph = HoldComplete[
        Graph[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14}, {
         Null, {{1, 2}, {1, 3}, {1, 4}, {2, 5}, {2, 6}, {2, 7}, {3, 8}, {3, 
          9}, {3, 10}, {4, 11}, {4, 12}, {4, 13}, {1, 14}}}, {
         GraphLayout -> {"Dimension" -> 2}, VertexLabels -> {None}, 
          VertexSize -> {0.2}, VertexStyle -> {14 -> RGBColor[1, 0, 0]}}]]}, 
       TagBox[
        GraphicsGroupBox[
         GraphicsComplexBox[{{2.294558781116753, 1.0198039027185568`}, {
          0.5099019513592784, 0.5099019513592784}, {2.0396078054371136`, 
          0.5099019513592784}, {3.569313659514949, 0.5099019513592784}, {0., 
          0.}, {0.5099019513592784, 0.}, {1.0198039027185568`, 0.}, {
          1.5297058540778354`, 0.}, {2.0396078054371136`, 0.}, {
          2.5495097567963922`, 0.}, {3.059411708155671, 0.}, {
          3.569313659514949, 0.}, {4.079215610874227, 0.}, {4.079215610874227,
           0.5099019513592784}}, {
           {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
            {Arrowheads[0.], ArrowBox[{1, 2}, 0.05099019513592782]}, 
            {Arrowheads[0.], ArrowBox[{1, 3}, 0.05099019513592782]}, 
            {Arrowheads[0.], ArrowBox[{1, 4}, 0.05099019513592782]}, 
            {Arrowheads[0.], ArrowBox[{1, 14}, 0.05099019513592782]}, 
            {Arrowheads[0.], ArrowBox[{2, 5}, 0.05099019513592782]}, 
            {Arrowheads[0.], ArrowBox[{2, 6}, 0.05099019513592782]}, 
            {Arrowheads[0.], ArrowBox[{2, 7}, 0.05099019513592782]}, 
            {Arrowheads[0.], ArrowBox[{3, 8}, 0.05099019513592782]}, 
            {Arrowheads[0.], ArrowBox[{3, 9}, 0.05099019513592782]}, 
            {Arrowheads[0.], ArrowBox[{3, 10}, 0.05099019513592782]}, 
            {Arrowheads[0.], ArrowBox[{4, 11}, 0.05099019513592782]}, 
            {Arrowheads[0.], ArrowBox[{4, 12}, 0.05099019513592782]}, 
            {Arrowheads[0.], ArrowBox[{4, 13}, 0.05099019513592782]}}, 
           {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
            DiskBox[1, 0.05099019513592782], DiskBox[2, 0.05099019513592782], 
            DiskBox[3, 0.05099019513592782], DiskBox[4, 0.05099019513592782], 
            DiskBox[5, 0.05099019513592782], DiskBox[6, 0.05099019513592782], 
            DiskBox[7, 0.05099019513592782], DiskBox[8, 0.05099019513592782], 
            DiskBox[9, 0.05099019513592782], DiskBox[10, 0.05099019513592782],
             DiskBox[11, 0.05099019513592782], 
            DiskBox[12, 0.05099019513592782], 
            DiskBox[13, 0.05099019513592782], 
            {RGBColor[1, 0, 0], DiskBox[14, 0.05099019513592782]}}}]],
        MouseAppearanceTag["NetworkGraphics"]],
       AllowKernelInitialization->False]],
     DefaultBaseStyle->{
      "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
     FormatType->TraditionalForm,
     FrameTicks->None,
     ImageCache->GraphicsData["CompressedBitmap", "\<\
eJy1ln9MU1cUxy+WX05G1Gxx6v4gWbIl+8Nkf+0v/9g/mizRucxMIZPJGItC
GAy6xGTLZBFxilM3t8mPCaObSFtbkdLyo4AUGLj+oCgdGEFiNboJGVOEUqDL
2bvn3fu4rz62JcMmfe0795x3Pt9zz733bcvQ78vKzdDvz8xI2VqQkb9vf2Zh
ypa8AsmkiyGEpEnfjSmE/gfpL7voQPoQHQwODkIgEMC7BA1b4jL7/Z/YGLyS
FfgTCx6fH97Z+z5k5+RQl3htc8IT9F6Wh0SpuujogC3bd6OHJD5e25zwBL2X
5SEqVTqYnVtAjxqjQ5laarM0toPH61dawOUdRT+pRio/aiurqVf8pkNzYKWx
gl9zz9CSsVXnG5XYUJjlFfy6fIt5ZWZJkjxU5/BCjzRM7+KZrbTKCSPBcZWt
4OgFmF+I4N1TzDZ6ewIqzT0qP1vnINguX1PZyozdMHZnQhU7Nx+Bj0utKr8b
t+7D8eo2lc3lGQFzSz+7Q/Q4dmNo+AW6GTq3iejcRtFpReldErN5AkEFnfuJ
6NxG0fuHbqtiH07PKujcT0Tntk73DTjX6GYdhOhc1Y8COp8JEZ3bCo5aFPRk
DXTuJ6Jzm4jOYym6vtSi8hPRuY2i19o9ghyllyh6l3dEmBA1OrfJ6GG8W62B
zv1EdG4T0Xns1HRYQed+Ijq3iehyuZWl8ZPNraDzpSuic9tH2DAy+loNdO4n
onObiM5jZXSryk9E57ZOzyK6XG6ykukQ0PHDsEXiGdYnz7AQgRg/jFYLlIdM
YXtYlRAGqeJrlPnkmrLlnKjiE0oK+V+YKdg65iYyCdXjMNyNchQes4gM+P+y
GwHkpGRVVG0KD1WCw9mNOUOz8+uj6kDzfVNlhc+OG2guPvxoJoy5aB598fdQ
XWeH83bPP5zQ8j4QCyWna2Fn6rvw+o5U8PkGNqI5DvOZGpzw5tt7YFfaXhpN
NrAxmuxUpRnDtm7fhWP8iLnmcsGHmzdDblaWcHAmMUx+AL21Ox2KvjRA38AY
LdMGFmy65BTPJy6O9kRz969wttYmDsey4etjv4Ol1Q+mnemQJ7020fSLp5uc
eqVyyri9/Siu+mIfdklJRTNc6rgqHQPjZB0rF/UtOmmA3ise8hza1sDQzd+g
QpoA2qTWtgGYkorATiOc1cmHM7gZnqnrgpxiI5yoaYeWn4fgz5tBuKrX08Lw
U2stWxu37v4BdlcAjp11Qv4RM85vr59WJMyaWQcdV65DXZNPaPA42hZYj0++
aoBThg7wBoJs40hQivH5d3Y4cKIeNzr/8B1YWIjw1fgscw2F57ESP9T34Z4k
VoIvenH/W4PXp2FYSkErQTuUVmJi8pFSAdrB0RW4e/8B63Ky/j8oT9ZQnsxS
o3LpFYIqPyk9XlKOqaNV08XEVcux5PklVB8ub4L6dll1kobqVexKU1SYmGqn
H0alvWEptXL1SApLGbw3CY4ubbWJGmoTWcrQ7Bw+8tOvbfh4a5sfLkhvEUXf
Pq5SnlTywr+qnBBehhZVxrFVQlVSvOxDRjhS0SLtWU5FXWvvMNwbf8Amkbz0
mLpWyCsxqdStYLPH1Qn7ECJSdbmHjfDBwXOYMkqVPGfkZfxZjctyCVG4baal
Z0Lqnvcg68Bp2JZ9BnbklkNxWRMHl6eDbGJSRW6DuQl3lldfewPyDpZj/kjk
L1ZO8gqrGH0r5W+gL8pDaaofEvM3+XXkDw==\
\>"]], ",", "13"}], "]"}], "]"}]], "Input",ExpressionUUID->"aeaf8a1d-241e-462e-b465-e69ee74bff07"]
}, Closed]],

Cell[CellGroupData[{

Cell["Detecting Products of Symmetric Groups", "Subsection",ExpressionUUID->"c27d1182-8272-4d3b-9e50-3f3eb184f12d"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ProductOfSymmetricGroupsQ", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductOfSymmetricGroupsQ", "[", "group_PermutationGroup", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"orbits", "=", 
      RowBox[{"GroupOrbits", "@", "group"}]}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"GroupOrder", "/@", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"GroupStabilizer", "[", 
           RowBox[{"group", ",", 
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"Flatten", "@", "orbits"}], ",", "#"}], "]"}]}], "]"}], 
          "&"}], "/@", "orbits"}], "\[IndentingNewLine]", ")"}]}], 
      "\[IndentingNewLine]", ")"}], "\[Equal]", 
     RowBox[{"(", 
      RowBox[{"Factorial", "/@", 
       RowBox[{"Length", "/@", "orbits"}]}], ")"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellLabel->"In[26]:=",ExpressionUUID->"f38dc84c-b1bd-4f80-a420-a8f5e447a465"],

Cell[BoxData[{
 RowBox[{"GroupForGraph", "[", 
  RowBox[{
   GraphicsBox[
    NamespaceBox["NetworkGraphics",
     DynamicModuleBox[{Typeset`graph = HoldComplete[
       Graph[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17}, {
        Null, {{1, 2}, {1, 3}, {1, 4}, {1, 5}, {1, 6}, {1, 7}, {1, 8}, {1, 
         9}, {1, 10}, {1, 11}, {1, 12}, {12, 13}, {12, 14}, {12, 15}, {12, 
         16}, {12, 17}}}, {
        GraphLayout -> {"Dimension" -> 2}, VertexLabels -> {None}, 
         VertexSize -> {0.2}, VertexStyle -> {17 -> RGBColor[1, 0, 0]}}]]}, 
      TagBox[
       GraphicsGroupBox[
        GraphicsComplexBox[{{1.7149858514250882`, 0.6859943405700353}, {0., 
         0.34299717028501764`}, {0.34299717028501764`, 
         0.34299717028501764`}, {0.6859943405700353, 0.34299717028501764`}, {
         1.028991510855053, 0.34299717028501764`}, {1.3719886811400706`, 
         0.34299717028501764`}, {1.7149858514250882`, 0.34299717028501764`}, {
         2.057983021710106, 0.34299717028501764`}, {2.4009801919951235`, 
         0.34299717028501764`}, {2.743977362280141, 0.34299717028501764`}, {
         3.0869745325651587`, 0.34299717028501764`}, {3.4299717028501764`, 
         0.34299717028501764`}, {2.743977362280141, 0.}, {3.0869745325651587`,
          0.}, {3.4299717028501764`, 0.}, {3.7729688731351945`, 0.}, {
         4.115966043420212, 0.}}, {
          {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
           {Arrowheads[0.], ArrowBox[{1, 2}, 0.03429971702850172]}, 
           {Arrowheads[0.], ArrowBox[{1, 3}, 0.03429971702850172]}, 
           {Arrowheads[0.], ArrowBox[{1, 4}, 0.03429971702850172]}, 
           {Arrowheads[0.], ArrowBox[{1, 5}, 0.03429971702850172]}, 
           {Arrowheads[0.], ArrowBox[{1, 6}, 0.03429971702850172]}, 
           {Arrowheads[0.], ArrowBox[{1, 7}, 0.03429971702850172]}, 
           {Arrowheads[0.], ArrowBox[{1, 8}, 0.03429971702850172]}, 
           {Arrowheads[0.], ArrowBox[{1, 9}, 0.03429971702850172]}, 
           {Arrowheads[0.], ArrowBox[{1, 10}, 0.03429971702850172]}, 
           {Arrowheads[0.], ArrowBox[{1, 11}, 0.03429971702850172]}, 
           {Arrowheads[0.], ArrowBox[{1, 12}, 0.03429971702850172]}, 
           {Arrowheads[0.], ArrowBox[{12, 13}, 0.03429971702850172]}, 
           {Arrowheads[0.], ArrowBox[{12, 14}, 0.03429971702850172]}, 
           {Arrowheads[0.], ArrowBox[{12, 15}, 0.03429971702850172]}, 
           {Arrowheads[0.], ArrowBox[{12, 16}, 0.03429971702850172]}, 
           {Arrowheads[0.], ArrowBox[{12, 17}, 0.03429971702850172]}}, 
          {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
           DiskBox[1, 0.03429971702850172], DiskBox[2, 0.03429971702850172], 
           DiskBox[3, 0.03429971702850172], DiskBox[4, 0.03429971702850172], 
           DiskBox[5, 0.03429971702850172], DiskBox[6, 0.03429971702850172], 
           DiskBox[7, 0.03429971702850172], DiskBox[8, 0.03429971702850172], 
           DiskBox[9, 0.03429971702850172], DiskBox[10, 0.03429971702850172], 
           DiskBox[11, 0.03429971702850172], DiskBox[12, 0.03429971702850172],
            DiskBox[13, 0.03429971702850172], 
           DiskBox[14, 0.03429971702850172], DiskBox[15, 0.03429971702850172],
            DiskBox[16, 0.03429971702850172], 
           {RGBColor[1, 0, 0], DiskBox[17, 0.03429971702850172]}}}]],
       MouseAppearanceTag["NetworkGraphics"]],
      AllowKernelInitialization->False]],
    DefaultBaseStyle->{
     "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
    FormatType->TraditionalForm,
    FrameTicks->None], ",", "16"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProductOfSymmetricGroupsQ", "@", "%"}], "\[IndentingNewLine]", 
 RowBox[{"GroupOrbits", "@", "%%"}], "\[IndentingNewLine]"}], "Input",Expressi\
onUUID->"6ef330cb-fb4c-44db-8d2e-ef8efe336e57"],

Cell[BoxData[{
 RowBox[{"GroupForGraph", "[", 
  RowBox[{
   GraphicsBox[
    NamespaceBox["NetworkGraphics",
     DynamicModuleBox[{Typeset`graph = HoldComplete[
       Graph[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14}, {
        Null, {{1, 2}, {1, 3}, {1, 4}, {2, 5}, {2, 6}, {2, 7}, {3, 8}, {3, 
         9}, {3, 10}, {4, 11}, {4, 12}, {4, 13}, {1, 14}}}, {
        GraphLayout -> {"Dimension" -> 2}, VertexLabels -> {None}, 
         VertexSize -> {0.2}, VertexStyle -> {14 -> RGBColor[1, 0, 0]}}]]}, 
      TagBox[
       GraphicsGroupBox[
        GraphicsComplexBox[{{2.294558781116753, 1.0198039027185568`}, {
         0.5099019513592784, 0.5099019513592784}, {2.0396078054371136`, 
         0.5099019513592784}, {3.569313659514949, 0.5099019513592784}, {0., 
         0.}, {0.5099019513592784, 0.}, {1.0198039027185568`, 0.}, {
         1.5297058540778354`, 0.}, {2.0396078054371136`, 0.}, {
         2.5495097567963922`, 0.}, {3.059411708155671, 0.}, {
         3.569313659514949, 0.}, {4.079215610874227, 0.}, {4.079215610874227, 
         0.5099019513592784}}, {
          {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
           {Arrowheads[0.], ArrowBox[{1, 2}, 0.05099019513592782]}, 
           {Arrowheads[0.], ArrowBox[{1, 3}, 0.05099019513592782]}, 
           {Arrowheads[0.], ArrowBox[{1, 4}, 0.05099019513592782]}, 
           {Arrowheads[0.], ArrowBox[{1, 14}, 0.05099019513592782]}, 
           {Arrowheads[0.], ArrowBox[{2, 5}, 0.05099019513592782]}, 
           {Arrowheads[0.], ArrowBox[{2, 6}, 0.05099019513592782]}, 
           {Arrowheads[0.], ArrowBox[{2, 7}, 0.05099019513592782]}, 
           {Arrowheads[0.], ArrowBox[{3, 8}, 0.05099019513592782]}, 
           {Arrowheads[0.], ArrowBox[{3, 9}, 0.05099019513592782]}, 
           {Arrowheads[0.], ArrowBox[{3, 10}, 0.05099019513592782]}, 
           {Arrowheads[0.], ArrowBox[{4, 11}, 0.05099019513592782]}, 
           {Arrowheads[0.], ArrowBox[{4, 12}, 0.05099019513592782]}, 
           {Arrowheads[0.], ArrowBox[{4, 13}, 0.05099019513592782]}}, 
          {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
           DiskBox[1, 0.05099019513592782], DiskBox[2, 0.05099019513592782], 
           DiskBox[3, 0.05099019513592782], DiskBox[4, 0.05099019513592782], 
           DiskBox[5, 0.05099019513592782], DiskBox[6, 0.05099019513592782], 
           DiskBox[7, 0.05099019513592782], DiskBox[8, 0.05099019513592782], 
           DiskBox[9, 0.05099019513592782], DiskBox[10, 0.05099019513592782], 
           DiskBox[11, 0.05099019513592782], DiskBox[12, 0.05099019513592782],
            DiskBox[13, 0.05099019513592782], 
           {RGBColor[1, 0, 0], DiskBox[14, 0.05099019513592782]}}}]],
       MouseAppearanceTag["NetworkGraphics"]],
      AllowKernelInitialization->False]],
    DefaultBaseStyle->{
     "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
    FormatType->TraditionalForm,
    FrameTicks->None], ",", "13"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProductOfSymmetricGroupsQ", "@", "%"}]}], "Input",ExpressionUUID->\
"d7d2cf99-dffb-424a-92aa-3f092a20b377"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "CanonicalizeByOrbits", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "sort", " ", "graph", " ", "vertices", " ", "such", " ", "that", " ", 
     "environment", " ", "all", " ", "the", " ", "way", " ", "to", " ", "the",
      " ", "right"}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "orbits", " ", "of", " ", "size"}], " ", ">", " ", 
     RowBox[{"1", " ", "come", " ", "up", " ", "first"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CanonicalizeByOrbits", "[", 
   RowBox[{"graph_Graph", ",", "kSys_Integer", ",", 
    RowBox[{"extraStabilizedVertices_List:", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"orbits", "=", 
       RowBox[{"GroupOrbits", "[", 
        RowBox[{
         RowBox[{"GroupForGraph", "[", 
          RowBox[{"graph", ",", "kSys", ",", "extraStabilizedVertices"}], 
          "]"}], ",", 
         RowBox[{"Range", "@", 
          RowBox[{"VertexCount", "@", "graph"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"kTot", "=", 
       RowBox[{"VertexCount", "@", "graph"}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"coloring", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Thread", "/@", 
           RowBox[{"MapIndexed", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"orbit", ",", "i"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{"environment", " ", "last"}], ",", " ", 
                 RowBox[{"length", " ", "1", " ", "next"}], ",", " ", 
                 RowBox[{
                  RowBox[{"nontrivial", " ", "orbits", " ", "first"}], ";", 
                  " ", 
                  RowBox[{
                  "stable", " ", "sort", " ", "so", " ", "add", " ", 
                   "i"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Min", "@", "orbit"}], ">", "kSys"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"orbit", "\[Rule]", 
                  RowBox[{
                   RowBox[{"10", "kTot"}], "+", 
                   RowBox[{"First", "@", "i"}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "@", "orbit"}], "\[Equal]", "1"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"orbit", "\[Rule]", 
                    RowBox[{
                    RowBox[{"5", "kTot"}], "+", 
                    RowBox[{"First", "@", "i"}]}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"orbit", "\[Rule]", 
                    RowBox[{"First", "@", "i"}]}]}], "\[IndentingNewLine]", 
                  "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
             "orbits"}], "]"}]}], "//", "Flatten"}], "//", 
         RowBox[{"SortBy", "[", "First", "]"}]}]}], "\[IndentingNewLine]", 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Graph", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"IGBlissCanonicalGraph", "[", 
         RowBox[{"{", 
          RowBox[{"graph", ",", 
           RowBox[{"\"\<VertexColors\>\"", "\[Rule]", 
            RowBox[{"Last", "/@", "coloring"}]}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"VertexLabels", "\[Rule]", "\"\<Index\>\""}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[28]:=",ExpressionUUID->"89d94e7e-a083-41fe-804e-5f69e6c36ddf"],

Cell[BoxData[
 RowBox[{"CanonicalizeByOrbits", "[", 
  RowBox[{
   GraphicsBox[
    NamespaceBox["NetworkGraphics",
     DynamicModuleBox[{Typeset`graph = HoldComplete[
       Graph[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17}, {
        Null, {{1, 2}, {1, 3}, {1, 4}, {1, 5}, {1, 6}, {1, 7}, {1, 8}, {1, 
         9}, {1, 10}, {1, 11}, {1, 12}, {12, 13}, {12, 14}, {12, 15}, {12, 
         16}, {12, 17}}}, {
        FormatType -> TraditionalForm, GraphLayout -> {"Dimension" -> 2}, 
         VertexLabels -> {"Index"}, VertexSize -> {0.2}, 
         VertexStyle -> {17 -> RGBColor[1, 0, 0]}}]]}, 
      TagBox[GraphicsGroupBox[{
         {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {0., 
            0.34299717028501764`}}, 0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {
            0.34299717028501764`, 0.34299717028501764`}}, 
            0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {
            0.6859943405700353, 0.34299717028501764`}}, 0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {
            1.028991510855053, 0.34299717028501764`}}, 0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {
            1.3719886811400706`, 0.34299717028501764`}}, 
            0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {
            1.7149858514250882`, 0.34299717028501764`}}, 
            0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {
            2.057983021710106, 0.34299717028501764`}}, 0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {
            2.4009801919951235`, 0.34299717028501764`}}, 
            0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {
            2.743977362280141, 0.34299717028501764`}}, 0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {
            3.0869745325651587`, 0.34299717028501764`}}, 
            0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {
            3.4299717028501764`, 0.34299717028501764`}}, 
            0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{3.4299717028501764`, 0.34299717028501764`}, {
            2.743977362280141, 0.}}, 0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{3.4299717028501764`, 0.34299717028501764`}, {
            3.0869745325651587`, 0.}}, 0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{3.4299717028501764`, 0.34299717028501764`}, {
            3.4299717028501764`, 0.}}, 0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{3.4299717028501764`, 0.34299717028501764`}, {
            3.7729688731351945`, 0.}}, 0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{3.4299717028501764`, 0.34299717028501764`}, {
            4.115966043420212, 0.}}, 0.03429971702850172]}}, 
         {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
          0.7]}], {
           DiskBox[{1.7149858514250882, 0.6859943405700353}, 
            0.03429971702850172], 
           InsetBox["1", 
            Offset[{2, 2}, {1.74928556845359, 0.720294057598537}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{0., 0.34299717028501764}, 0.03429971702850172], 
           InsetBox["2", 
            Offset[{2, 2}, {0.03429971702850172, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{0.34299717028501764, 0.34299717028501764}, 
            0.03429971702850172], 
           InsetBox["3", 
            Offset[{2, 2}, {0.37729688731351935, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{0.6859943405700353, 0.34299717028501764}, 
            0.03429971702850172], 
           InsetBox["4", 
            Offset[{2, 2}, {0.720294057598537, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{1.028991510855053, 0.34299717028501764}, 
            0.03429971702850172], 
           InsetBox["5", 
            Offset[{2, 2}, {1.0632912278835547, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{1.3719886811400706, 0.34299717028501764}, 
            0.03429971702850172], 
           InsetBox["6", 
            Offset[{2, 2}, {1.4062883981685723, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{1.7149858514250882, 0.34299717028501764}, 
            0.03429971702850172], 
           InsetBox["7", 
            Offset[{2, 2}, {1.74928556845359, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{2.057983021710106, 0.34299717028501764}, 
            0.03429971702850172], 
           InsetBox["8", 
            Offset[{2, 2}, {2.0922827387386076, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{2.4009801919951235, 0.34299717028501764}, 
            0.03429971702850172], 
           InsetBox["9", 
            Offset[{2, 2}, {2.4352799090236252, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{2.743977362280141, 0.34299717028501764}, 
            0.03429971702850172], 
           InsetBox["10", 
            Offset[{2, 2}, {2.778277079308643, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{3.0869745325651587, 0.34299717028501764}, 
            0.03429971702850172], 
           InsetBox["11", 
            Offset[{2, 2}, {3.1212742495936605, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{3.4299717028501764, 0.34299717028501764}, 
            0.03429971702850172], 
           InsetBox["12", 
            Offset[{2, 2}, {3.464271419878678, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{2.743977362280141, 0.}, 0.03429971702850172], 
           InsetBox["13", 
            Offset[{2, 2}, {2.778277079308643, 0.03429971702850172}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{3.0869745325651587, 0.}, 0.03429971702850172], 
           InsetBox["14", 
            Offset[{2, 2}, {3.1212742495936605, 0.03429971702850172}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{3.4299717028501764, 0.}, 0.03429971702850172], 
           InsetBox["15", 
            Offset[{2, 2}, {3.464271419878678, 0.03429971702850172}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{3.7729688731351945, 0.}, 0.03429971702850172], 
           InsetBox["16", 
            Offset[{2, 2}, {3.8072685901636962, 0.03429971702850172}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           {RGBColor[1, 0, 0], 
            DiskBox[{4.115966043420212, 0.}, 0.03429971702850172]}, 
           InsetBox["17", 
            Offset[{2, 2}, {4.150265760448713, 0.03429971702850172}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}}}],
       MouseAppearanceTag["NetworkGraphics"]],
      AllowKernelInitialization->False]],
    DefaultBaseStyle->{
     "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
    FormatType->TraditionalForm,
    FrameTicks->None,
    ImageSize->{373., Automatic},
    ImageCache->GraphicsData["CompressedBitmap", "\<\
eJztW2toVdkVXrnnnHtvbnLzfpjEREdjaHyP8YGJ6Titj6qJFmHK2CHOmGTI
DJ0yrZ0GqUFEfMD0R35YtKWQGQmFARFxRESsiIgVsWKtz/4QBX8oWusL34/0
rP1a+9yzz8lJtZ3KTDD3nrP2Wmuvvdbea++9vti64rOPPvz5is8+7lgxcv7K
Fb/46OOOX42c9+lKl2RlAWT9GgDeGQn4POA+io8B999AN34g5dU838KvGLS0
tFQZnioNtEIu+C/2ZcPkac3Qv/uv7Nd9rhgSeVg4d4sYOv66zwW855vsy/II
xdgnpw1wR0HpK+YrGaI+3foY+xQ0wZfmw/mnZG9pUWqtkO5fFV/xf6BPDsf6
1gxnsMnWtfZP7PebmmzFfF2iCZFnHFu6bNFZSrpE0VwZ1CZlylRDuTAJW5EP
f2P4WaK0WJyZ1upD1aRLe3RHoJUqLTwzwGNFCGSPQCO7q7jap4oQyB6BRiGp
5mqfe71sYo9AK1JaRmi+hRSAFmH8PXbsGEycOBFSqRTMnTsX3lu5GaWKhE78
kXptjSbFcw19c75sX1dHjx6FCRMmsK7mzJkDV65cAccgnxsgf+vWLXijfhrY
8QQz+ezZs8qlOm9M0HJycuD69eviLdQLdXV1cPjwYXj8+DFs374d5s+frxxY
kNEFmvqyrhgzZgzz/LNnz+DUqVPM87ZBPm2Qx/bvTXkbtm7dCk+ePIF9+/ZB
Y2NjqCumTp0KBw8e9LvCyy5NuHfvHiSTSVLBHJEneDKMcfA9HTh4cw/Pnz9n
80A3UpfN0wYusyZSKisr4c6dO+wZB59IJEIH3t3dDRs2bIg68P7+fqioqCAa
GziPbNIXxZq6N2Hv3r1cLQibB/eBpfngzJkzLDjBPuA0Kc/5HIjFYtDb2wsP
HjyAAwcOQENDQ6gfTp8+zdbMIH6ICaPv3r0L6XSatW3bti2hXJEKcMXFixeh
qKwaHj16FO6KHL8Xa2qgubmZLdcZM2bAuXPn1DzPVx1LqzP8gPHv6elhxo4b
Nw5Onjxp9IP0+cKFC2H//v2aDrgvmnDNY9/4I9MS5gOcE5MmTXIno7QlbpCQ
gV6zZg1M+8E7EOSFmEFWGrd8+XL0duCiyCVv8O40JVJHfX09HD9+nL2VhIzs
/PnzLGvgJMxwxI4dO2DUqFGaaQ5zADoC47t7924oLy93QynNsQ2Skvbw4UMY
O3bsoA4x9drX1wdtbW2e1JdWvVohkjgnVq1aBffv32cJffTo0VBk4JehxGS6
adMm9pbF3fFANOE2hcPVpx0uW5yrOP3Gjx/PlqDfMF1SumPXrl0qqZmSpklW
uujSpUsgf2L4QRGIhxiLEejs7ISCggLmB9wIioP4WXrPwvzC3CB8wWwrUL3l
GAxPRaTRMnpT003nlUCZCLSk0tKg6aaTW6BMBBrlwGma7jJFDZSJQIsrLTM0
3cMUNVAmAs1RWmZquit9M8cnE4FGW2STpnu4ogbKRKDRbaNZ012jqIEyEWh0
pnlL0z3St4BNecpPsz00qeNtrllM9yGUTIbOR3eImJgGGQaxk4rLaB6D+/ZD
bmxSjOe/Wab55nVTPhATT7rDbcu8rSsPzeUekivx/72c9G2xz1PRCCu7IPM8
HkOZ8V6HotN39hHfd+F7re2bFy2Dytu+pZeh/My2h1mrlg2mNwrf65BJI2U+
ycxgGDsiMzvnOxGZRVSTvAO3Ja6k8xTNVt0XKho7Y1GQbb77yjGVKlqF4alU
H/sA37mpwlysNFtKokBZ4ChanrI0rmgL+HDKVVOpEixXastV98NEsPQDlanI
HFjPjnk1l6neypQF73KThitCiZeJBANL56YCdXjpnDSTA0qVBfxGDm8oQrGX
iQQDy+6m4nZ42Z00kwNKlAXt3KQ6RSjyMpFgYMneVEcPL9mTZnJAsbKgi5s0
ThEKvUwkGFjuL4poJl2fSTM5oEhZ8Ak3KV+oqK6u9hYU+ORxfKgAL9V3iWK4
TVcNb5UtrTpPCEWmmj/ddgsEF1b2ly5dykqAxeU1rLJvGrq8l+mVfVPZPSX0
XrhwAWbOnAnZ2dnsG98px5DTXNaW91ezohCqbm9vZ5W/tBosLxz46/hYSqmq
qgLL4s78ccdafh3MN3jHMtBKhKWZilEZK8XM8kYMy82zZs2Ca9euQYWQNYEX
jgq5p4QqK08DMs1bdJV2jKgElVTyBFdHR4cHeyivrgsNlo49mApHOULv7Nmz
2TCwpL1nzx4WsJhaNhbNOQdqa2th586dbN5s3LiRFV2zVbCCQJPaCY3QtOB9
6Fj9BTT+qA2WLFmiFlO0OCV8cdLj8X0eKokXXb16FZYtWwaXL1+GKkHTgZVs
FSLxxIqmclVogfGiJVQ/4zM/bsREpNsCYqLDIqaCW65wNK6Gp08Z0gntv+kD
y3a0eSNLXlhLxhIvvtFWr008P46DS+3mTY6X37hxgy2iocXCjHPoThd1I+kH
7A7PqLdv34ZKQdPxHjoO2GIkixYt0vEdxzs0S6wpHcahCn1KTBgTUCMnpJwp
pgjpgI2pbJkWEcJeF7zXDZ0929iSaGpq0tJwUkyREydOsAjl5ubCunXr5GSy
1bp2aHn5sxxy4yjxGXOD4zgvFSzJp0dE5DmZSDCxIByCb7KAngFK0SnAbVv2
aS8rxAv8iZKBnMkSZULwuGx4LfzkZ7/lEdeKt2Y4yVQ0C4M7dYjJVLhNi5gg
rfWDHuZNtvZtGw4dOpRSwcsRjFOmTGEKO3u+ZPkrFrNUmnNos/XHDTW/ePFC
xQ17eJm4yRHqwWnyxg2neX4+363k4VgH0SoEreGtpQomI0jB1rOKDw2jUXsK
1zriFfznBOZY6SiYqRCuIW68GfET3CIxKWKn7ntC2aZxO2A7cfhwTT+TwlmJ
GY5Svky6fhjQ8eRz3FfwLFAYyO+lmSA/OTA9NiJs+aJL3PkRmUKoaMuWLSxX
yLOgCfqTYdTBvZh3cLa+gelAnmPwlzyBmGA7U6HfdI6QsdehvEBZrczPHY5B
xc3zyJEj4vDlWYbakddhJxPMtTh6XAtdXV2cnw5cYIYlFy9eDJs3b2apbP36
9dDa2qpC6+f30kpC9Jri5zk5OmxgGEo8fkyePJnNXhliE5wpt0gJWPJcNKAf
WWRBwYdLxr3Oi+nOM6GRpmVrOpYQQuk24M7qaTAp0GCoOOsKLyPoAnQFnjal
oTRn48JQXD7Tp09nux8eFT9Y9UegKy6YsVa874wYMYKlWvQkdllk4DfBvCUh
ek3REwF+VwUlqcaQ8o4rELQ1nSzCQVvSTFOA0tofuEltipDwMpFgINZrwlHD
sV7STA5IKgv6uEntihD3MpFgIERs2sXDIWLSTA5IKAv4pgBdiuB4mUgwEFk2
bVbhyDJpJgfQev6Km/SJItheJhIMBKRNizgckCbN5AC6uO7gJv1SESwvEwkG
4tim9B+OY5NmcgCl9q+5Sd2KEPMykWAg/G2ClsPhb9JMDrCUBeJ2sloRRA9d
4rJFGx2pCMTPTWk0HD8nzeQKOgj8mRu3Fr+yVROxe3ZhvQM5AnkTy2iLeXWZ
hpxBY3yHuDkblKW4l//0c8UkezEr9VspUPWAPw3w60jh51+4EZ9rnnBtSGSw
82K2H5WQ9x3dbPeZkfkRGHq1ECObJZmYIltTijTO4X4ytr9xFb/TBoQMhVX1
7tAJdtF6P8sltgiJwUAg/qd9sFWwD4YuCPbf84i5Lf/gBNY6hP+48qXoT7/N
/P1/39QnmvTT+Rlvk366E01fiCb9XHA6fLyQ9W/zdc7U\
\>"]], ",", "16"}], "]"}]], "Input",ExpressionUUID->"723d325a-6232-44cd-99cf-c4d70f0f072e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Detecting Multiple Hairs per Orbit", "Subsection",ExpressionUUID->"07ee9774-0138-40b1-8109-cc7b2ad50df3"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "OrbitsHaveMultipleHairsQ", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OrbitsHaveMultipleHairsQ", "[", 
   RowBox[{"group_PermutationGroup", ",", "g_Graph", ",", "kSys_Integer"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"environmentVertices", "=", 
       RowBox[{
        RowBox[{"VertexList", "[", "g", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"kSys", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], ",",
       "\[IndentingNewLine]", "hairNeighbourIndices"}], "\[IndentingNewLine]",
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"hairNeighbourIndices", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"VertexIndex", "[", 
         RowBox[{"g", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"VertexList", "@", 
        RowBox[{"Subgraph", "[", 
         RowBox[{
          RowBox[{"NeighborhoodGraph", "[", 
           RowBox[{"g", ",", "environmentVertices"}], "]"}], ",", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"VertexList", "@", "g"}], ",", "environmentVertices"}], 
           "]"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Intersection", "[", 
         RowBox[{"#", ",", "hairNeighbourIndices"}], "]"}], "&"}], "/@", 
       RowBox[{"GroupOrbits", "[", "group", "]"}]}], "//", 
      RowBox[{
       RowBox[{"AnyTrue", "[", 
        RowBox[{"#", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "##"}], ">", "1"}], "&"}]}], "]"}], 
       "&"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[30]:=",ExpressionUUID->"b57cd762-c7e4-4f36-99e2-f7cf8ab16166"],

Cell[BoxData[{
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3, 4}, {Null, {{1, 2}, {1, 3}, {2, 4}}}, {
      FormatType -> TraditionalForm, GraphLayout -> {"Dimension" -> 2}, 
       VertexLabels -> {"Index"}, VertexSize -> {0.2}, 
       VertexStyle -> {3 -> RGBColor[1, 0, 0], 4 -> RGBColor[1, 0, 0]}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
        {Arrowheads[0.], 
         ArrowBox[{{2., 2.4492935982947064`*^-16}, {1., 
          3.6739403974420594`*^-16}}, 0.1]}, 
        {Arrowheads[0.], 
         ArrowBox[{{2., 2.4492935982947064`*^-16}, {3., 0.}}, 0.1]}, 
        {Arrowheads[0.], 
         ArrowBox[{{1., 3.6739403974420594`*^-16}, {0., 
          4.898587196589413*^-16}}, 0.1]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{2., 2.4492935982947064*^-16}, 0.1], 
         InsetBox["1", Offset[{2, 2}, {2.1, 0.10000000000000026}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1., 3.6739403974420594*^-16}, 0.1], 
         InsetBox["2", Offset[{2, 2}, {1.1, 0.10000000000000037}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[1, 0, 0], DiskBox[{3., 0.}, 0.1]}, 
         InsetBox["3", Offset[{2, 2}, {3.1, 0.1}], ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[1, 0, 0], DiskBox[{0., 4.898587196589413*^-16}, 0.1]}, 
         InsetBox["4", Offset[{2, 2}, {0.1, 0.10000000000000049}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None], "\[IndentingNewLine]", 
 RowBox[{"Subgroup", "[", 
  RowBox[{
   RowBox[{"GroupForGraph", "[", 
    RowBox[{"%", ",", "2"}], "]"}], ",", "2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"OrbitsHaveMultipleHairsQ", "[", 
  RowBox[{"%", ",", "%%", ",", "2"}], "]"}]}], "Input",ExpressionUUID->\
"e5511290-b440-4fcf-90d5-a66ddae31c59"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "CoffeeCode Link",
 StyleBox[" [See individual sections for tests]", "Subtitle"]
}], "Section",ExpressionUUID->"eaeee47d-59a1-438f-8328-c2b8308da014"],

Cell[CellGroupData[{

Cell["Exporting MM symbols", "Subsection",ExpressionUUID->"18c6a61f-6d2d-4038-8178-0790ffc4b2d0"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ExportAdjacencyMatrix", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportAdjacencyMatrix", "[", "g_Graph", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"Avec", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"g", "//", "AdjacencyMatrix"}], "//", "Normal"}], "//", 
       "Flatten"}]}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"ToString", "/@", "Avec"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[32]:=",ExpressionUUID->"0b73b4fb-a095-4932-8585-2685f5888ef2"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "SGSTransversalMMForm", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SGSTransversalMMForm", "[", 
    RowBox[{"list_List", ",", "kSys_Integer"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"list", "/.", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{
          RowBox[{"{", "idx_Integer", "}"}], ",", 
          RowBox[{"PermutationGroup", "[", "cycles_List", "]"}]}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"permutationIndices", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"PermutationList", "[", 
               RowBox[{"#", ",", "kSys"}], "]"}], "&"}], "/@", "cycles"}]}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "the", " ", "pivot", " ", "point", " ", "is", " ", "the", " ", 
             "first", " ", "index", " ", "for", " ", "which", " ", "the", " ",
              "SGSGenerator", " ", "acts", " ", "nontrivially", " ", "on", 
             " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "so", " ", "one", " ", "point", " ", "past", " ", "the", " ", 
                "points", " ", "that", " ", "are", " ", "stabilized"}], ")"}],
               ".", "\[IndentingNewLine]", "If"}], " ", "the", " ", "pivot", 
             " ", "point", " ", "for", " ", "the", " ", "SGSGenerator", " ", 
             "is", " ", "2"}], ",", " ", 
            RowBox[{
             RowBox[{
             "that", " ", "means", " ", "we", " ", "want", " ", "to", " ", 
              "check", " ", "indices", " ", "0", " ", "and", " ", "1", " ", 
              "in", " ", 
              RowBox[{"C", "++"}]}], ";", " ", 
             RowBox[{
             "in", " ", "MM", " ", "this", " ", "would", " ", "correspond", 
              " ", "to", " ", "indices", " ", 
              RowBox[{"{", 
               RowBox[{"1", ",", " ", "2"}], "}"}]}]}], ",", " ", 
            RowBox[{"which", " ", "is", " ", 
             RowBox[{"what", " ", "\[LeftDoubleBracket]", 
              RowBox[{";;", "2"}], "\[RightDoubleBracket]"}], " ", 
             "truncates", " ", 
             RowBox[{"to", ".", "\[IndentingNewLine]", "Therefore"}], " ", 
             "we", " ", "validly", " ", 
             RowBox[{"don", "'"}], "t", " ", "subtract", " ", "1", " ", 
             "from", " ", "the", " ", "pivot", " ", "point"}], ",", " ", 
            RowBox[{
            "but", " ", "do", " ", "subtract", " ", "1", " ", "from", " ", 
             "all", " ", "other", " ", "indices"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"StringRiffle", "[", 
             RowBox[{
              RowBox[{"Flatten", "@", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\"\<\\tSGSGenerator<\>\"", "<>", 
                  RowBox[{"ToString", "@", 
                   RowBox[{"(", "#1", ")"}]}], "<>", "\"\<, Group<\>\""}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"\"\<\\t\\tPermutation<\>\"", "<>", 
                    RowBox[{"StringRiffle", "[", 
                    RowBox[{
                    RowBox[{"ToString", "/@", 
                    RowBox[{"(", 
                    RowBox[{"##", "-", "1"}], ")"}]}], ",", "\"\<,\>\""}], 
                    "]"}], "<>", "\"\<>\>\""}], ")"}], "&"}], "/@", "#2"}], 
                 ",", "\[IndentingNewLine]", "\"\<\\t>>\>\""}], 
                "\[IndentingNewLine]", "}"}]}], ",", "\"\<\\n\>\""}], "]"}], 
            "&"}], "@@", 
           RowBox[{"{", 
            RowBox[{"idx", ",", "permutationIndices"}], "}"}]}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "}"}]}], "//", "Flatten"}], "//", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\"\<using sgs = SGSTransversal<\\n\>\"", "<>", 
       RowBox[{"StringRiffle", "[", 
        RowBox[{"#", ",", "\"\<,\\n\>\""}], "]"}], "<>", "\"\<\\n>;\>\""}], 
      ")"}], "&"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "for", " ", "the", " ", "trivial", " ", "transversal", " ", "we", " ", 
     "simply", " ", "pass", " ", "an", " ", "orbit"}], ",", " ", 
    RowBox[{
    "sort", " ", "the", " ", "graph", " ", "canonically", " ", "etc"}]}], " ",
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "TrivialSGSTransversalMMForm", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrivialSGSTransversalMMForm", "[", 
   RowBox[{"list_List", ",", "kSys_Integer"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"orbits", "=", 
      RowBox[{
       RowBox[{"list", "/.", 
        RowBox[{
         RowBox[{"{", "n_Integer", "}"}], "\[RuleDelayed]", "Nothing"}]}], "//", 
       RowBox[{"SortBy", "[", "First", "]"}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"lengths", "=", 
        RowBox[{"Accumulate", "[", 
         RowBox[{"Length", "/@", "orbits"}], "]"}]}], "\[IndentingNewLine]", 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"orbitBounds", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "0", "}"}], "~", "Join", "~", "lengths"}], "//", 
            RowBox[{
             RowBox[{"Partition", "[", 
              RowBox[{"#", ",", "2", ",", "1"}], "]"}], "&"}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"StringRiffle", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{"\"\<\\tTrivialSGSOrbit<\>\"", "<>", 
               RowBox[{"ToString", "[", "#1", "]"}], "<>", "\"\<, \>\"", "<>", 
               RowBox[{"ToString", "[", "#2", "]"}], "<>", "\"\<>\>\""}], 
              "\[IndentingNewLine]", ")"}], "&"}], "@@@", "orbitBounds"}], 
           ",", "\[IndentingNewLine]", "\"\<,\\n\>\""}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], "//", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\"\<using sgs = TrivialSGSTransversal<\>\"", "<>", 
          RowBox[{"ToString", "[", "kSys", "]"}], "<>", "\"\<,\\n\>\"", "<>", 
          "#", "<>", "\"\<\\n>;\>\""}], ")"}], "&"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[34]:=",ExpressionUUID->"0a4bcd86-0730-4679-8af5-e40188c89035"],

Cell[BoxData[{
 RowBox[{"Subgroup", "[", 
  RowBox[{
   RowBox[{"GroupForGraph", "[", 
    RowBox[{
     GraphicsBox[
      NamespaceBox["NetworkGraphics",
       DynamicModuleBox[{Typeset`graph = HoldComplete[
         Graph[{1, 2, 3, 4}, {Null, {{1, 2}, {1, 3}, {2, 4}}}, {
          FormatType -> TraditionalForm, GraphLayout -> {"Dimension" -> 2}, 
           VertexLabels -> {"Index"}, VertexSize -> {0.2}, 
           VertexStyle -> {
            3 -> RGBColor[1, 0, 0], 4 -> RGBColor[1, 0, 0]}}]]}, 
        TagBox[GraphicsGroupBox[{
           {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
            {Arrowheads[0.], 
             ArrowBox[{{2., 2.4492935982947064`*^-16}, {1., 
              3.6739403974420594`*^-16}}, 0.1]}, 
            {Arrowheads[0.], 
             ArrowBox[{{2., 2.4492935982947064`*^-16}, {3., 0.}}, 0.1]}, 
            {Arrowheads[0.], 
             ArrowBox[{{1., 3.6739403974420594`*^-16}, {0., 
              4.898587196589413*^-16}}, 0.1]}}, 
           {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
            0.7]}], {DiskBox[{2., 2.4492935982947064*^-16}, 0.1], 
             InsetBox["1", Offset[{2, 2}, {2.1, 0.10000000000000026}], 
              ImageScaled[{0, 0}],
              BaseStyle->"Graphics"]}, {
             DiskBox[{1., 3.6739403974420594*^-16}, 0.1], 
             InsetBox["2", Offset[{2, 2}, {1.1, 0.10000000000000037}], 
              ImageScaled[{0, 0}],
              BaseStyle->"Graphics"]}, {
             {RGBColor[1, 0, 0], DiskBox[{3., 0.}, 0.1]}, 
             InsetBox["3", Offset[{2, 2}, {3.1, 0.1}], ImageScaled[{0, 0}],
              BaseStyle->"Graphics"]}, {
             {RGBColor[1, 0, 0], DiskBox[{0., 4.898587196589413*^-16}, 0.1]}, 
             InsetBox["4", Offset[{2, 2}, {0.1, 0.10000000000000049}], 
              ImageScaled[{0, 0}],
              BaseStyle->"Graphics"]}}}],
         MouseAppearanceTag["NetworkGraphics"]],
        AllowKernelInitialization->False]],
      DefaultBaseStyle->{
       "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> 
        Hue[0.8, 1., 0.6]},
      FormatType->TraditionalForm,
      FrameTicks->None], ",", "2"}], "]"}], ",", "2"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TrivialSGSTransversalMMForm", "[", 
  RowBox[{
   RowBox[{"GroupOrbits", "@", "%"}], ",", "2"}], "]"}]}], "Input",ExpressionU\
UID->"13df2506-edac-4825-8123-50a2d3379f19"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ExportSymmetricCCInstance", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportSymmetricCCInstance", "[", 
   RowBox[{"graph_Graph", ",", "kSys_Integer", ",", 
    RowBox[{"extraStabilizedVertices_List:", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"name_:", "\"\<graphstate_instance\>\""}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"group", "=", 
       RowBox[{"Subgroup", "[", 
        RowBox[{
         RowBox[{"GroupForGraph", "[", 
          RowBox[{"graph", ",", "kSys", ",", "extraStabilizedVertices"}], 
          "]"}], ",", "kSys"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"kTot", "=", 
       RowBox[{"VertexCount", "@", "graph"}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"!", 
        RowBox[{"OrbitsHaveMultipleHairsQ", "[", 
         RowBox[{"group", ",", "graph", ",", "kSys"}], "]"}]}], "\[And]", 
       RowBox[{"ProductOfSymmetricGroupsQ", "@", "group"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "write", " ", "Orbits", " ", "as", " ", "expected", " ", "for", " ", 
        "TrivialSGS", " ", "Solver"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"orbits", "=", 
           RowBox[{"GroupOrbits", "@", "group"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"graphCanonicalized", "=", 
           RowBox[{"CanonicalizeByOrbits", "[", 
            RowBox[{"graph", ",", "kSys", ",", "extraStabilizedVertices"}], 
            "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "orbits"}], "\[Equal]", "0"}], "\[Or]", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"Length", "/@", "orbits"}], "]"}], "\[Equal]", "1"}]}], 
           ",", 
           RowBox[{
            RowBox[{
            "Echo", "[", 
             "\"\<WARN: symmetry group is 0. Not a valid symmetric problem \
instance.\>\"", "]"}], ";", 
            RowBox[{"Throw", "[", "\"\<invalid instance\>\"", "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Echo", "[", 
            "\"\<Product symmetry group with single hairs detected. Compiling \
for trivial canonical image provider.\>\"", "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
         "\"\<struct \>\"", "<>", "name", "<>", "\"\< {\\n\>\"", "<>", 
          "\[IndentingNewLine]", 
          RowBox[{"TrivialSGSTransversalMMForm", "[", 
           RowBox[{"orbits", ",", "kSys"}], "]"}], "<>", "\"\<\\n\>\"", "<>", 
          "\[IndentingNewLine]", "\"\<constexpr static size_t k_sys = \>\"", "<>", 
          RowBox[{"ToString", "[", "kSys", "]"}], "<>", "\"\<, k_env = \>\"", 
          "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"kTot", "-", "kSys"}], "]"}], "<>", "\"\<;\\n\>\"", "<>", 
          "\[IndentingNewLine]", "\"\<constexpr static AdjacencyMatrixT<\>\"",
           "<>", 
          RowBox[{"ToString", "[", "kTot", "]"}], "<>", 
          "\"\<> adjacency_matrix{\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Normal", "@", 
            RowBox[{"AdjacencyMatrix", "@", "graphCanonicalized"}]}], "]"}], 
          "<>", "\"\<};\\n\>\"", "<>", "\[IndentingNewLine]", 
          "\"\<};\>\""}]}]}], "\[IndentingNewLine]", "]"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "write", " ", "SGSGenerators", " ", "as", " ", "expected", " ", "for", 
        " ", "Nauty"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"sgs", "=", 
          RowBox[{"SGSTransversal", "@", "group"}]}], "\[IndentingNewLine]", 
         "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "sgs"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{
            "Echo", "[", 
             "\"\<WARN: symmetry group is 0. Not a valid symmetric problem \
instance.\>\"", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Throw", "[", "\"\<invalid instance\>\"", "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
         "Echo", "[", 
          "\"\<Nested symmetry group or multiple hairs per orbit detected. \
Compiling for nauty's canonical image provider.\>\"", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
         "\"\<struct \>\"", "<>", "name", "<>", "\"\< {\\n\>\"", "<>", 
          "\[IndentingNewLine]", 
          RowBox[{"SGSTransversalMMForm", "[", 
           RowBox[{"sgs", ",", "kSys"}], "]"}], "<>", "\"\<\\n\>\"", "<>", 
          "\[IndentingNewLine]", "\"\<constexpr static size_t k_sys = \>\"", "<>", 
          RowBox[{"ToString", "[", "kSys", "]"}], "<>", "\"\<, k_env = \>\"", 
          "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"kTot", "-", "kSys"}], "]"}], "<>", "\"\<;\\n\>\"", "<>", 
          "\[IndentingNewLine]", "\"\<constexpr static AdjacencyMatrixT<\>\"",
           "<>", 
          RowBox[{"ToString", "[", "kTot", "]"}], "<>", 
          "\"\<> adjacency_matrix{\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Normal", "@", 
            RowBox[{"AdjacencyMatrix", "@", "graph"}]}], "]"}], "<>", 
          "\"\<};\\n\>\"", "<>", "\[IndentingNewLine]", "\"\<};\>\""}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[38]:=",ExpressionUUID->"d83ed393-10ab-4d3d-92f7-a87393c5e075"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "can", " ", "enforce", " ", "to", " ", "use", " ", "the", " ", "non"}], 
    "-", 
    RowBox[{
    "nauty", " ", "symmetric", " ", "solver", " ", "by", " ", "flagging", " ",
      "certain", " ", "vertices", " ", "as", " ", "not", " ", "symmetric"}]}],
    " ", "*)"}], 
  RowBox[{"ExportSymmetricCCInstance", "[", 
   RowBox[{
    GraphicsBox[
     NamespaceBox["NetworkGraphics",
      DynamicModuleBox[{Typeset`graph = HoldComplete[
        Graph[{1, 2, 3, 4, 5, 6, 7, 8}, {
         Null, {{1, 2}, {2, 3}, {2, 4}, {1, 5}, {5, 6}, {5, 7}, {1, 8}}}, {
         AlignmentPoint -> Center, GraphLayout -> {"Dimension" -> 2}, 
          ImageSize -> {100, 100}, VertexLabels -> {None}, 
          VertexSize -> {0.2}, VertexStyle -> {8 -> RGBColor[1, 0, 0]}}]]}, 
       TagBox[
        GraphicsGroupBox[
         GraphicsComplexBox[{{1.4819171472698969`, 1.4819171472698969`}, {
          0.3704792868174742, 0.7409585736349484}, {0., 0.}, {
          0.7409585736349484, 0.}, {1.852396434087371, 0.7409585736349484}, {
          1.4819171472698969`, 0.}, {2.2228757209048453`, 0.}, {
          2.5933550077223195`, 0.7409585736349484}}, {
           {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
            {Arrowheads[0.], ArrowBox[{1, 2}, 0.07409585736349485]}, 
            {Arrowheads[0.], ArrowBox[{1, 5}, 0.07409585736349485]}, 
            {Arrowheads[0.], ArrowBox[{1, 8}, 0.07409585736349485]}, 
            {Arrowheads[0.], ArrowBox[{2, 3}, 0.07409585736349485]}, 
            {Arrowheads[0.], ArrowBox[{2, 4}, 0.07409585736349485]}, 
            {Arrowheads[0.], ArrowBox[{5, 6}, 0.07409585736349485]}, 
            {Arrowheads[0.], ArrowBox[{5, 7}, 0.07409585736349485]}}, 
           {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
            DiskBox[1, 0.07409585736349485], DiskBox[2, 0.07409585736349485], 
            DiskBox[3, 0.07409585736349485], DiskBox[4, 0.07409585736349485], 
            DiskBox[5, 0.07409585736349485], DiskBox[6, 0.07409585736349485], 
            DiskBox[7, 0.07409585736349485], 
            {RGBColor[1, 0, 0], DiskBox[8, 0.07409585736349485]}}}]],
        MouseAppearanceTag["NetworkGraphics"]],
       AllowKernelInitialization->False]],
     DefaultBaseStyle->{
      "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
     FormatType->TraditionalForm,
     FrameTicks->None,
     ImageSize->{100, 100}], ",", "7", ",", 
    RowBox[{"{", "2", "}"}]}], "]"}]}]], "Input",ExpressionUUID->"0b908c26-\
74b6-49a8-bd8c-6968c93103dd"]
}, Closed]],

Cell[CellGroupData[{

Cell["Build Interface", "Subsection",ExpressionUUID->"95e22c55-9322-4b85-bb76-28abbdca20b9"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "MakeCC", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeCC", "[", 
   RowBox[{"kSys_Integer", ",", "kEnv_Integer"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"out", "=", 
      RowBox[{"RunProcess", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
         "\"\<make\>\"", ",", "\[IndentingNewLine]", "\"\<-B\>\"", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<K_SYS=\>\"", "<>", 
           RowBox[{"ToString", "@", "kSys"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<K_ENV=\>\"", "<>", 
           RowBox[{"ToString", "@", "kEnv"}]}]}], "\[IndentingNewLine]", 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ProcessDirectory", "\[Rule]", 
         RowBox[{"ParallelBuildDirectory", "[", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"out", "[", "\"\<ExitCode\>\"", "]"}], "\[NotEqual]", "0"}], 
        "\[Or]", 
        RowBox[{
         RowBox[{"out", "[", "\"\<StandardError\>\"", "]"}], "\[NotEqual]", 
         "\"\<\>\""}]}], ",", 
       RowBox[{
        RowBox[{"Echo", "[", "out", "]"}], ";", 
        RowBox[{"Throw", "[", "\"\<make error\>\"", "]"}]}]}], "]"}], ";"}]}],
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeCC", "[", 
   RowBox[{"graph_Graph", ",", "kSys_Integer", ",", 
    RowBox[{"extraStabilizedVertices_List:", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"instanceFileContent", "=", 
      RowBox[{"ExportSymmetricCCInstance", "[", 
       RowBox[{"graph", ",", "kSys", ",", "extraStabilizedVertices"}], 
       "]"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ParallelBuildDirectory", "[", "]"}], "<>", 
        "CCCUSTOMINSTANCEFILE"}], ",", "instanceFileContent", ",", 
       "\"\<Text\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"MakeCC", "[", 
      RowBox[{"kSys", ",", 
       RowBox[{
        RowBox[{"VertexCount", "@", "graph"}], "-", "kSys"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[40]:=",ExpressionUUID->"9bf39e14-7948-465e-a2ae-fc0c723f51b3"],

Cell[BoxData[
 RowBox[{"MakeCC", "[", 
  RowBox[{"9", ",", "1"}], "]"}]], "Input",ExpressionUUID->"836949d6-bd62-\
41ff-b96b-2b7101662f77"],

Cell[BoxData[
 RowBox[{"MakeCC", "[", 
  RowBox[{
   GraphicsBox[
    NamespaceBox["NetworkGraphics",
     DynamicModuleBox[{Typeset`graph = HoldComplete[
       Graph[{1, 2, 3, 4, 5, 6, 7, 8}, {
        Null, {{1, 2}, {2, 3}, {2, 4}, {1, 5}, {5, 6}, {5, 7}, {1, 8}}}, {
        AlignmentPoint -> Center, GraphLayout -> {"Dimension" -> 2}, 
         ImageSize -> {100, 100}, VertexLabels -> {None}, VertexSize -> {0.2},
          VertexStyle -> {8 -> RGBColor[1, 0, 0]}}]]}, 
      TagBox[
       GraphicsGroupBox[
        GraphicsComplexBox[{{1.4819171472698969`, 1.4819171472698969`}, {
         0.3704792868174742, 0.7409585736349484}, {0., 0.}, {
         0.7409585736349484, 0.}, {1.852396434087371, 0.7409585736349484}, {
         1.4819171472698969`, 0.}, {2.2228757209048453`, 0.}, {
         2.5933550077223195`, 0.7409585736349484}}, {
          {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
           {Arrowheads[0.], ArrowBox[{1, 2}, 0.07409585736349485]}, 
           {Arrowheads[0.], ArrowBox[{1, 5}, 0.07409585736349485]}, 
           {Arrowheads[0.], ArrowBox[{1, 8}, 0.07409585736349485]}, 
           {Arrowheads[0.], ArrowBox[{2, 3}, 0.07409585736349485]}, 
           {Arrowheads[0.], ArrowBox[{2, 4}, 0.07409585736349485]}, 
           {Arrowheads[0.], ArrowBox[{5, 6}, 0.07409585736349485]}, 
           {Arrowheads[0.], ArrowBox[{5, 7}, 0.07409585736349485]}}, 
          {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
           DiskBox[1, 0.07409585736349485], DiskBox[2, 0.07409585736349485], 
           DiskBox[3, 0.07409585736349485], DiskBox[4, 0.07409585736349485], 
           DiskBox[5, 0.07409585736349485], DiskBox[6, 0.07409585736349485], 
           DiskBox[7, 0.07409585736349485], 
           {RGBColor[1, 0, 0], DiskBox[8, 0.07409585736349485]}}}]],
       MouseAppearanceTag["NetworkGraphics"]],
      AllowKernelInitialization->False]],
    DefaultBaseStyle->{
     "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
    FormatType->TraditionalForm,
    FrameTicks->None,
    ImageSize->{100, 100}], ",", "7"}], "]"}]], "Input",
 CellLabel->"In[62]:=",ExpressionUUID->"b6f00e29-b817-4457-b4b7-99f87623c85f"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "RunCC", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RunCC", "[", 
   RowBox[{"graph_Graph", ",", "kSys_Integer", ",", 
    RowBox[{"extraStabilizedVertices_List:", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MakeCC", "[", 
         RowBox[{"graph", ",", "kSys", ",", "extraStabilizedVertices"}], 
         "]"}]}], ",", 
       RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"ccResult", "=", 
         RowBox[{"RunProcess", "[", 
          RowBox[{"\"\<CoffeeCode\>\"", ",", "All", ",", 
           RowBox[{"ProcessDirectory", "\[Rule]", 
            RowBox[{"ParallelBuildDirectory", "[", "]"}]}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ccResult", "[", "\"\<ExitCode\>\"", "]"}], "\[NotEqual]",
             "0"}], "\[Or]", 
           RowBox[{
            RowBox[{"ccResult", "[", "\"\<StandardError\>\"", "]"}], 
            "\[NotEqual]", "\"\<\>\""}]}], ",", 
          RowBox[{
           RowBox[{"Echo", "[", "ccResult", "]"}], ";", 
           RowBox[{"Throw", "[", "\"\<run error\>\"", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ImportString", "[", 
         RowBox[{
          RowBox[{"ccResult", "[", "\"\<StandardOutput\>\"", "]"}], ",", 
          "\"\<RawJSON\>\""}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[43]:=",ExpressionUUID->"294c5f12-1b01-4659-b521-b6eb5e7cebd3"],

Cell[BoxData[
 RowBox[{"RunCC", "[", 
  RowBox[{
   GraphicsBox[
    NamespaceBox["NetworkGraphics",
     DynamicModuleBox[{Typeset`graph = HoldComplete[
       Graph[{1, 2, 3, 4, 5, 6, 7, 8}, {
        Null, {{1, 2}, {2, 3}, {2, 4}, {1, 5}, {5, 6}, {5, 7}, {1, 8}}}, {
        AlignmentPoint -> Center, GraphLayout -> {"Dimension" -> 2}, 
         ImageSize -> {100, 100}, VertexLabels -> {None}, VertexSize -> {0.2},
          VertexStyle -> {8 -> RGBColor[1, 0, 0]}}]]}, 
      TagBox[
       GraphicsGroupBox[
        GraphicsComplexBox[{{1.4819171472698969`, 1.4819171472698969`}, {
         0.3704792868174742, 0.7409585736349484}, {0., 0.}, {
         0.7409585736349484, 0.}, {1.852396434087371, 0.7409585736349484}, {
         1.4819171472698969`, 0.}, {2.2228757209048453`, 0.}, {
         2.5933550077223195`, 0.7409585736349484}}, {
          {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
           {Arrowheads[0.], ArrowBox[{1, 2}, 0.07409585736349485]}, 
           {Arrowheads[0.], ArrowBox[{1, 5}, 0.07409585736349485]}, 
           {Arrowheads[0.], ArrowBox[{1, 8}, 0.07409585736349485]}, 
           {Arrowheads[0.], ArrowBox[{2, 3}, 0.07409585736349485]}, 
           {Arrowheads[0.], ArrowBox[{2, 4}, 0.07409585736349485]}, 
           {Arrowheads[0.], ArrowBox[{5, 6}, 0.07409585736349485]}, 
           {Arrowheads[0.], ArrowBox[{5, 7}, 0.07409585736349485]}}, 
          {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
           DiskBox[1, 0.07409585736349485], DiskBox[2, 0.07409585736349485], 
           DiskBox[3, 0.07409585736349485], DiskBox[4, 0.07409585736349485], 
           DiskBox[5, 0.07409585736349485], DiskBox[6, 0.07409585736349485], 
           DiskBox[7, 0.07409585736349485], 
           {RGBColor[1, 0, 0], DiskBox[8, 0.07409585736349485]}}}]],
       MouseAppearanceTag["NetworkGraphics"]],
      AllowKernelInitialization->False]],
    DefaultBaseStyle->{
     "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
    FormatType->TraditionalForm,
    FrameTicks->None,
    ImageSize->{100, 100}], ",", "7", ",", 
   RowBox[{"{", "2", "}"}]}], "]"}]], "Input",
 CellLabel->"In[64]:=",ExpressionUUID->"57e342af-dc52-449e-8eab-3f6e3001876f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Full Solver Interface", "Subsection",ExpressionUUID->"17756b3f-3473-48b9-9981-e5202fb0b160"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "CCPath", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CCPath", "[", 
    RowBox[{"kSys_Integer", ",", "kEnv_Integer"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"CCPath", "[", 
     RowBox[{"kSys", ",", "kEnv"}], "]"}], "=", 
    RowBox[{"CCRELEASEPATHFULLSOLVER", "<>", "\"\<CoffeeCode.\>\"", "<>", 
     RowBox[{"ToString", "[", "kSys", "]"}], "<>", "\"\<.\>\"", "<>", 
     RowBox[{"ToString", "[", "kEnv", "]"}]}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"RunCC", " ", "overload"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RunCC", "[", 
   RowBox[{"graph_Graph", ",", "kSys_Integer", ",", "\"\<Full\>\"", ",", 
    RowBox[{"extraStabilizedVertices_List:", 
     RowBox[{"{", "}"}]}]}], 
   RowBox[{"(*", "ignored", "*)"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"adjacencyMatrix", "=", 
       RowBox[{"ExportAdjacencyMatrix", "@", "graph"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"kEnv", "=", 
       RowBox[{
        RowBox[{"VertexCount", "@", "graph"}], "-", "kSys"}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"executable", "=", 
        RowBox[{"CCPath", "[", 
         RowBox[{"kSys", ",", "kEnv"}], "]"}]}], "\[IndentingNewLine]", "}"}],
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Assert", "[", 
        RowBox[{"FileExistsQ", "[", "executable", "]"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"ccResult", "=", 
           RowBox[{"RunProcess", "[", 
            RowBox[{"executable", ",", "All", ",", "adjacencyMatrix"}], 
            "]"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"ccResult", "[", "\"\<ExitCode\>\"", "]"}], 
              "\[NotEqual]", "0"}], "\[Or]", 
             RowBox[{
              RowBox[{"ccResult", "[", "\"\<StandardError\>\"", "]"}], 
              "\[NotEqual]", "\"\<\>\""}]}], ",", 
            RowBox[{
             RowBox[{"Echo", "[", "ccResult", "]"}], ";", 
             RowBox[{"Throw", "[", "\"\<run error\>\"", "]"}]}]}], "]"}], ";",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"ImportString", "[", 
           RowBox[{
            RowBox[{"ccResult", "[", "\"\<StandardOutput\>\"", "]"}], ",", 
            "\"\<RawJSON\>\""}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[45]:=",ExpressionUUID->"60cf9552-f3ec-4557-9d53-682c589fa289"],

Cell[BoxData[
 RowBox[{"RunCC", "[", 
  RowBox[{
   GraphicsBox[
    NamespaceBox["NetworkGraphics",
     DynamicModuleBox[{Typeset`graph = HoldComplete[
       Graph[{1, 2, 3, 4, 5, 6, 7}, {
        Null, {{1, 2}, {1, 3}, {2, 4}, {2, 5}, {3, 6}, {4, 7}}}, {
        GraphLayout -> {"Dimension" -> 2}, VertexLabels -> {None}, 
         VertexSize -> {0.2}, VertexStyle -> {7 -> RGBColor[1, 0, 0]}}]]}, 
      TagBox[
       GraphicsGroupBox[
        GraphicsComplexBox[{{1.1088319064318592`, 2.6611965754364624`}, {
         0.4435327625727437, 1.774131050290975}, {1.7741310502909748`, 
         1.774131050290975}, {0., 0.8870655251454875}, {0.8870655251454874, 
         0.8870655251454875}, {1.7741310502909748`, 0.8870655251454875}, {0., 
         0.}}, {
          {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
           {Arrowheads[0.], ArrowBox[{1, 2}, 0.08870655251454874]}, 
           {Arrowheads[0.], ArrowBox[{1, 3}, 0.08870655251454874]}, 
           {Arrowheads[0.], ArrowBox[{2, 4}, 0.08870655251454874]}, 
           {Arrowheads[0.], ArrowBox[{2, 5}, 0.08870655251454874]}, 
           {Arrowheads[0.], ArrowBox[{3, 6}, 0.08870655251454874]}, 
           {Arrowheads[0.], ArrowBox[{4, 7}, 0.08870655251454874]}}, 
          {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
           DiskBox[1, 0.08870655251454874], DiskBox[2, 0.08870655251454874], 
           DiskBox[3, 0.08870655251454874], DiskBox[4, 0.08870655251454874], 
           DiskBox[5, 0.08870655251454874], DiskBox[6, 0.08870655251454874], 
           {RGBColor[1, 0, 0], DiskBox[7, 0.08870655251454874]}}}]],
       MouseAppearanceTag["NetworkGraphics"]],
      AllowKernelInitialization->False]],
    DefaultBaseStyle->{
     "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
    FormatType->TraditionalForm,
    FrameTicks->None], ",", "6", ",", "\"\<Full\>\""}], "]"}]], "Input",Expres\
sionUUID->"edd014c9-3edf-427c-a5ed-408fc1410676"]
}, Closed]],

Cell[CellGroupData[{

Cell["Importing JSON format", "Subsection",ExpressionUUID->"78bfb35b-a715-4258-8cfb-ccbe9554565e"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"CoeffArrayToPoly", ",", "MultArrayToPoly"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoeffArrayToPoly", "[", "coeffs__Integer", "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", "coeffs", "}"}], "\[LeftDoubleBracket]", "i", 
      "\[RightDoubleBracket]"}], " ", 
     SuperscriptBox["q1", 
      RowBox[{"i", "-", "1"}]]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "@", 
       RowBox[{"{", "coeffs", "}"}]}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoeffArrayToPoly", "[", "coeffs__List", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"#1", " ", 
       SuperscriptBox["q1", 
        RowBox[{"#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]], 
       SuperscriptBox["q2", 
        RowBox[{"#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]], 
       SuperscriptBox["q3", 
        RowBox[{
        "#2", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]]}], 
      ")"}], "&"}], "@@@", 
    RowBox[{"{", "coeffs", "}"}]}], "//", "Total"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MultArrayToPoly", "[", 
   RowBox[{"{", 
    RowBox[{"mult_Integer", ",", "list_List"}], "}"}], "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{"mult", ",", "\[IndentingNewLine]", 
    RowBox[{"CoeffArrayToPoly", "@@", "list"}]}], "\[IndentingNewLine]", 
   "}"}]}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[48]:=",ExpressionUUID->"0d05934d-de45-4e75-9c77-711a417d82bc"],

Cell[BoxData[
 RowBox[{"CoeffArrayToPoly", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"888", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "2", ",", "2"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellLabel->"In[87]:=",ExpressionUUID->"97ebc215-ee1e-45e4-8c7d-98dd97a449fa"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "PauliActionCC", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PauliActionCC", "[", 
   RowBox[{"graph_Graph", ",", "kSys_Integer", ",", "p_", ",", 
    RowBox[{"symmetricSolver_:", "True"}], ",", 
    RowBox[{"extraStabilizedVertices_List:", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kTot", "=", 
       RowBox[{"VertexCount", "@", "graph"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"kEnv", "=", 
       RowBox[{
        RowBox[{"VertexCount", "@", "graph"}], "-", "kSys"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pp", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ListQ", "@", "p"}], ",", "p", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "p"}], ",", 
           RowBox[{"p", "/", "3"}], ",", 
           RowBox[{"p", "/", "3"}], ",", 
           RowBox[{"p", "/", "3"}]}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", "\[Lambda]", ",", "\[Lambda]a", ",", 
      "\[Lambda]m", ",", "\[Lambda]ma"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"kEnv", ">", "kSys"}], "\[Or]", 
        RowBox[{"kSys", "<", "1"}], "\[Or]", 
        RowBox[{"kTot", "<", "2"}]}], ",", 
       RowBox[{"Throw", "[", "\"\<invalid params\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"get", " ", "lambda", " ", "and", " ", "lambda_a"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Lambda]m", ",", "\[Lambda]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]ma", ",", "\[Lambda]a"}], "}"}]}], "}"}], "=", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"result", "=", 
          RowBox[{"If", "[", 
           RowBox[{"symmetricSolver", ",", "\[IndentingNewLine]", 
            RowBox[{"RunCC", "[", 
             RowBox[{"graph", ",", "kSys", ",", "extraStabilizedVertices"}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"RunCC", "[", 
             RowBox[{"graph", ",", "kSys", ",", "\"\<Full\>\""}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"MultArrayToPoly", "/@", 
            RowBox[{"result", "[", "\"\<lambda\>\"", "]"}]}], "//", 
           "Transpose"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MultArrayToPoly", "/@", 
            RowBox[{"result", "[", "\"\<lambda_a\>\"", "]"}]}], "//", 
           "Transpose"}]}], "\[IndentingNewLine]", "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "final", " ", "expression", " ", "in", " ", "the", " ", "variables", 
       " ", "given"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Thread", "/@", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["p0", "kSys"], 
            RowBox[{"{", 
             RowBox[{"\[Lambda]", ",", 
              RowBox[{"\[Lambda]a", "/", 
               SuperscriptBox["2", 
                RowBox[{"kTot", "-", "kSys"}]]}]}], "}"}]}], "/.", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"p0", "\[Rule]", 
              RowBox[{
              "pp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"q1", "\[Rule]", 
              RowBox[{
               RowBox[{
               "pp", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "/", 
               RowBox[{
               "pp", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"q2", "\[Rule]", 
              RowBox[{
               RowBox[{
               "pp", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               "/", 
               RowBox[{
               "pp", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"q3", "\[Rule]", 
              RowBox[{
               RowBox[{
               "pp", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
               "/", 
               RowBox[{
               "pp", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}]}], "\[IndentingNewLine]", 
            "}"}]}], "//", "Simplify"}], "\[IndentingNewLine]", ")"}], 
        "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]m", ",", "\[Lambda]ma"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[52]:=",ExpressionUUID->"08fb50c6-fd2a-426d-8f7c-650956d551e4"],

Cell[BoxData[
 RowBox[{"PauliActionCC", "[", 
  RowBox[{
   GraphicsBox[
    NamespaceBox["NetworkGraphics",
     DynamicModuleBox[{Typeset`graph = HoldComplete[
       Graph[{1, 2, 3, 4}, {Null, {{1, 2}, {2, 3}, {2, 4}}}, {
        FormatType -> TraditionalForm, GraphLayout -> {"Dimension" -> 2}, 
         VertexLabels -> {"Index"}, VertexSize -> {0.2}, 
         VertexStyle -> {4 -> RGBColor[1, 0, 0]}}]]}, 
      TagBox[GraphicsGroupBox[{
         {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
          {Arrowheads[0.], 
           ArrowBox[{{0., 0.}, {0.7745966692414834, 0.7745966692414834}}, 
            0.07745966692414835]}, 
          {Arrowheads[0.], 
           ArrowBox[{{0.7745966692414834, 0.7745966692414834}, {
            0.7745966692414834, 0.}}, 0.07745966692414835]}, 
          {Arrowheads[0.], 
           ArrowBox[{{0.7745966692414834, 0.7745966692414834}, {
            1.5491933384829668`, 0.}}, 0.07745966692414835]}}, 
         {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
          0.7]}], {DiskBox[{0., 0.}, 0.07745966692414835], 
           InsetBox["1", 
            Offset[{2, 2}, {0.07745966692414835, 0.07745966692414835}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{0.7745966692414834, 0.7745966692414834}, 
            0.07745966692414835], 
           InsetBox["2", 
            Offset[{2, 2}, {0.8520563361656317, 0.8520563361656317}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{0.7745966692414834, 0.}, 0.07745966692414835], 
           InsetBox["3", 
            Offset[{2, 2}, {0.8520563361656317, 0.07745966692414835}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           {RGBColor[1, 0, 0], 
            DiskBox[{1.5491933384829668, 0.}, 0.07745966692414835]}, 
           InsetBox["4", 
            Offset[{2, 2}, {1.626653005407115, 0.07745966692414835}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}}}],
       MouseAppearanceTag["NetworkGraphics"]],
      AllowKernelInitialization->False]],
    DefaultBaseStyle->{
     "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
    FormatType->TraditionalForm,
    FrameTicks->None,
    ImageCache->GraphicsData["CompressedBitmap", "\<\
eJzNVz1PG0EQHew77Dg4Jp+OCQZjsEnAsk0R0TglcYHzA6BAslAUKKJEhBpF
4j/QIysVokAuEAUVokCkRHRISBTQICGQAFfkZj/IXvw4X9IQS3u392b2vf2a
3fGH6vzMx8/V+dnpaqo8V/06Mzv9LfX+y5wDBduIaNIppRRx/capqsck3dw4
NYtfAapUKmlQ65BOAfFqZ4SKb99Rrf5TFK47WI9/c0Xpc+G6g0WkBgXFm524
rS2eQfHNOJcu8Qze+nCxWvhpMYukhukXcinrnmtl/v6T0Ryd5eFnDvNWmb+b
lM2xIOUEGHMrP61s/6fK9zfb97TDAoY7D4BLQDwl9un7D+HR3cJP02q/nuyI
jCJijUqTfFjKP1DuWoZL0if2SFJEgKnbJxaTFA+B6ZVPrFNSdABTl0/ssZuC
f9qM3OWS2bSzs0P5fJ4ikQiNjY3R0dERPblzniSvxtqaJbnGzbwks9ksbW1t
UaPRoJWVFSqXy6r3aF49JC2XyWmaACy2wi4uLigcDruYTb8oP20ivZuVhu3S
0MN76SFUq9UokUi4Zq15Ji0aHx+n9fV1FbsqeJsm8/fEuVmeAyyomM/Pzyka
jQqO5eVl1ImYcj04OKBcLkfX19dGJ3Q08Mrs7+8LIhuwPAOYpTBeXZ6KQqEg
5xbu1yAtLCzQ4uIiAfnV1VVKp9PC1A4onnpsMpZleR5YvV6neDwOw0vv9aur
KxoaGjK7oQOaQ4Kb8xfqBgoX3Y29vT0aHR2lUCgk5nlzcxMeFHom19bWbpde
7UO00ihcECbDkF4AU6dPTB5XFPcI0FaYPDRh0NwdIOjoJhTgaHMhTKZp8GRC
GwNhvZICneBoURGWkhToHkF3EML6JAW6zdBNiLC0pOgBprBPrF9S9AJTyCc2
IClSwITiDGEZSdEHTOjAQlhWUqSByfKJDUqKfmAK+sReS4oBNVLTxIWzHicb
QuJvZMuMYdL5VUAleOqPivBw7Dl3C5QMcualBYbd7q2y1mFzJK3T639z/8vO
eA3VTCiVe9Zw98pT1UROerzyiiqZTJL+Bfgx6LZzJlAqlejk5ESvaEGZjo+P
aWJigg4PD/U2KSrT6emp6NDZ2ZkmHFGmjY0NmpqaMre4Nl1eXlIsFjNNeRUe
mUxG3EF8HS4tLYkrcdDtsr29LW5XTqaKxSLt7u5qF/fQqe0XlKz9Ug==\
\>"]], ",", "3", ",", "p"}], "]"}]], "Input",
 CellLabel->"In[91]:=",ExpressionUUID->"13a101ed-0cfc-4c0d-82fa-7922bfd0149f"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["User Interface", "Chapter",ExpressionUUID->"6c8e77dd-fd20-4053-b686-04d3c83d53ea"],

Cell[CellGroupData[{

Cell["Entropy and CI", "Section",ExpressionUUID->"7cd42527-551f-4535-83c6-808d349bf01b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"presets", " ", "for", " ", "important", " ", "channels"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CHANNELDEPOLARIZING", "=", "p"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CHANNELBB84", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "-", 
        RowBox[{"2", "p"}], "-", 
        SuperscriptBox["p", "2"]}], ",", 
       RowBox[{"p", "-", 
        SuperscriptBox["p", "2"]}], ",", 
       SuperscriptBox["p", "2"], ",", 
       RowBox[{"p", "-", 
        SuperscriptBox["p", "2"]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CHANNEL2PAULI", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "-", 
        RowBox[{"2", "p"}]}], ",", "p", ",", "0", ",", "p"}], "}"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[54]:=",ExpressionUUID->"b6ce4992-8a66-4686-bc96-b6076a8d7d08"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"ShannonEntropyMult", ",", "CIMult"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ShannonEntropyMult", "[", "l_List", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"l", "/.", 
     RowBox[{
      RowBox[{"Rule", "[", 
       RowBox[{"0", ",", "_"}], "]"}], "\[RuleDelayed]", "0"}]}], "/.", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{"term_", ",", "mult_"}], "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"-", "mult"}], "*", "term", " ", 
      RowBox[{"Log2", "[", "term", "]"}]}]}]}], "//", 
   "Total"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CIMult", "[", 
   RowBox[{"\[Lambda]_", ",", "\[Lambda]a_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ShannonEntropyMult", "[", "\[Lambda]a", "]"}], "-", 
     RowBox[{"ShannonEntropyMult", "[", "\[Lambda]", "]"}]}], ")"}], "/", 
   RowBox[{"Log2", "@", 
    RowBox[{"Total", "@", 
     RowBox[{"(", 
      RowBox[{"Last", "/@", 
       RowBox[{"List", "@@", "\[Lambda]a"}]}], ")"}]}]}]}]}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[57]:=",ExpressionUUID->"f4608d96-84ba-4733-976d-4ec7f1fb79a1"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "CIThreshold", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CIThreshold", "[", 
   RowBox[{"g_Graph", ",", "kSys_Integer", ",", "p_", ",", 
    RowBox[{"symmetricSolver_:", "True"}], ",", 
    RowBox[{"extraStabilizedVertices_List:", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"pa", "=", 
      RowBox[{"PauliActionCC", "[", 
       RowBox[{
       "g", ",", "kSys", ",", "p", ",", "symmetricSolver", ",", 
        "extraStabilizedVertices"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"FindRoot", "[", 
     RowBox[{
      RowBox[{"CIMult", "@@", "pa"}], ",", 
      RowBox[{"{", 
       RowBox[{"p", ",", ".2"}], "}"}], ",", 
      RowBox[{"AccuracyGoal", "\[Rule]", "9"}], ",", 
      RowBox[{"MaxIterations", "\[Rule]", "1000"}], ",", 
      RowBox[{"WorkingPrecision", "\[Rule]", "30"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"fe05033a-e239-4efe-a1df-40b15440c395"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interface Tutorial", "Section",ExpressionUUID->"189f46b1-436d-45bd-b989-38c322e68899"],

Cell[CellGroupData[{

Cell["Manual Export", "Subsection",ExpressionUUID->"ed233b51-7d25-4213-826c-5184a50d3c84"],

Cell[CellGroupData[{

Cell["Create graphs by hand", "Subsubsection",ExpressionUUID->"23cddb85-a632-422c-a677-2ccbd4a7869b"],

Cell["To create graphs by hand, look up the following functions:", "Text",ExpressionUUID->"87db0a61-0fe8-4c97-b6e8-576611de5095"],

Cell[BoxData[{"AdjacencyGraph", "\[IndentingNewLine]", "SparseArray", "\
\[IndentingNewLine]", "PathGraph"}], "Input",ExpressionUUID->"5ff3cb61-7f74-\
42c0-851a-e975fca6b095"],

Cell["\<\
Or directly use MM\[CloseCurlyQuote]s Graph object, where edges are entered \
with ESC ue ESC\
\>", "Text",ExpressionUUID->"6548b310-e0f8-4ad8-b628-8547e7ec7bbe"],

Cell[BoxData[
 RowBox[{"Graph", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"1", "\[UndirectedEdge]", "2"}], ",", 
    RowBox[{"3", "\[UndirectedEdge]", "4"}], ",", 
    RowBox[{"3", "\[UndirectedEdge]", "5"}], ",", 
    RowBox[{"1", "\[UndirectedEdge]", "3"}]}], "}"}], "]"}]], "Input",Expressi\
onUUID->"d4f14064-833b-4ef1-b295-3a6f2fee498f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Create a random graph, add a hair, and plot.", "Subsubsection",ExpressionUUID->"d290f4db-2fe0-4f9a-bfda-df84839cf46b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CompleteGraph", "[", "10", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HairGraph", "[", 
   RowBox[{"%", ",", 
    RowBox[{"{", 
     RowBox[{"10", ",", "9"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"graph", "=", 
  RowBox[{"EnvironmentPlot", "[", 
   RowBox[{"%", ",", "10"}], "]"}]}]}], "Input",ExpressionUUID->"afdaf128-\
eb5b-47de-a0e9-2ede66743e42"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export instance", "Subsubsection",ExpressionUUID->"eb69490e-e745-4f7d-ab7f-3f296d527b40"],

Cell["Just adjacency matrix for Full Solver", "Text",ExpressionUUID->"5df465c7-68b8-4b7c-9d67-ac4c0479e2d6"],

Cell[BoxData[
 RowBox[{"ExportAdjacencyMatrix", "[", 
  GraphicsBox[
   NamespaceBox["NetworkGraphics",
    DynamicModuleBox[{Typeset`graph = HoldComplete[
      Graph[{1, 2, 3, 4}, {Null, {{1, 2}, {2, 3}, {2, 4}}}, {
       FormatType -> TraditionalForm, GraphLayout -> {"Dimension" -> 2}, 
        VertexLabels -> {"Index"}, VertexSize -> {0.2}, 
        VertexStyle -> {4 -> RGBColor[1, 0, 0]}}]]}, 
     TagBox[GraphicsGroupBox[{
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
         {Arrowheads[0.], 
          ArrowBox[{{0., 0.}, {0.7745966692414834, 0.7745966692414834}}, 
           0.07745966692414835]}, 
         {Arrowheads[0.], 
          ArrowBox[{{0.7745966692414834, 0.7745966692414834}, {
           0.7745966692414834, 0.}}, 0.07745966692414835]}, 
         {Arrowheads[0.], 
          ArrowBox[{{0.7745966692414834, 0.7745966692414834}, {
           1.5491933384829668`, 0.}}, 0.07745966692414835]}}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
         0.7]}], {DiskBox[{0., 0.}, 0.07745966692414835], 
          InsetBox["1", 
           Offset[{2, 2}, {0.07745966692414835, 0.07745966692414835}], 
           ImageScaled[{0, 0}],
           BaseStyle->"Graphics"]}, {
          DiskBox[{0.7745966692414834, 0.7745966692414834}, 
           0.07745966692414835], 
          InsetBox["2", 
           Offset[{2, 2}, {0.8520563361656317, 0.8520563361656317}], 
           ImageScaled[{0, 0}],
           BaseStyle->"Graphics"]}, {
          DiskBox[{0.7745966692414834, 0.}, 0.07745966692414835], 
          InsetBox["3", 
           Offset[{2, 2}, {0.8520563361656317, 0.07745966692414835}], 
           ImageScaled[{0, 0}],
           BaseStyle->"Graphics"]}, {
          {RGBColor[1, 0, 0], 
           DiskBox[{1.5491933384829668, 0.}, 0.07745966692414835]}, 
          InsetBox["4", 
           Offset[{2, 2}, {1.626653005407115, 0.07745966692414835}], 
           ImageScaled[{0, 0}],
           BaseStyle->"Graphics"]}}}],
      MouseAppearanceTag["NetworkGraphics"]],
     AllowKernelInitialization->False]],
   DefaultBaseStyle->{
    "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
   FormatType->TraditionalForm,
   FrameTicks->None], "]"}]], "Input",ExpressionUUID->"d8b9781b-be39-4820-8ed8-60df8fd4afd3"],

Cell["SGS for Symmetric Solver", "Text",ExpressionUUID->"8c35da14-2d2b-43d0-abff-1f0017a599b2"],

Cell[BoxData[
 RowBox[{"ExportSymmetricCCInstance", "[", 
  RowBox[{
   GraphicsBox[
    NamespaceBox["NetworkGraphics",
     DynamicModuleBox[{Typeset`graph = HoldComplete[
       Graph[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17}, {
        Null, {{1, 2}, {1, 3}, {1, 4}, {1, 5}, {1, 6}, {1, 7}, {1, 8}, {1, 
         9}, {1, 10}, {1, 11}, {1, 12}, {12, 13}, {12, 14}, {12, 15}, {12, 
         16}, {12, 17}}}, {
        FormatType -> TraditionalForm, GraphLayout -> {"Dimension" -> 2}, 
         VertexLabels -> {"Index"}, VertexSize -> {0.2}, 
         VertexStyle -> {17 -> RGBColor[1, 0, 0]}}]]}, 
      TagBox[GraphicsGroupBox[{
         {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {0., 
            0.34299717028501764`}}, 0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {
            0.34299717028501764`, 0.34299717028501764`}}, 
            0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {
            0.6859943405700353, 0.34299717028501764`}}, 0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {
            1.028991510855053, 0.34299717028501764`}}, 0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {
            1.3719886811400706`, 0.34299717028501764`}}, 
            0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {
            1.7149858514250882`, 0.34299717028501764`}}, 
            0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {
            2.057983021710106, 0.34299717028501764`}}, 0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {
            2.4009801919951235`, 0.34299717028501764`}}, 
            0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {
            2.743977362280141, 0.34299717028501764`}}, 0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {
            3.0869745325651587`, 0.34299717028501764`}}, 
            0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{1.7149858514250882`, 0.6859943405700353}, {
            3.4299717028501764`, 0.34299717028501764`}}, 
            0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{3.4299717028501764`, 0.34299717028501764`}, {
            2.743977362280141, 0.}}, 0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{3.4299717028501764`, 0.34299717028501764`}, {
            3.0869745325651587`, 0.}}, 0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{3.4299717028501764`, 0.34299717028501764`}, {
            3.4299717028501764`, 0.}}, 0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{3.4299717028501764`, 0.34299717028501764`}, {
            3.7729688731351945`, 0.}}, 0.03429971702850172]}, 
          {Arrowheads[0.], 
           ArrowBox[{{3.4299717028501764`, 0.34299717028501764`}, {
            4.115966043420212, 0.}}, 0.03429971702850172]}}, 
         {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
          0.7]}], {
           DiskBox[{1.7149858514250882, 0.6859943405700353}, 
            0.03429971702850172], 
           InsetBox["1", 
            Offset[{2, 2}, {1.74928556845359, 0.720294057598537}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{0., 0.34299717028501764}, 0.03429971702850172], 
           InsetBox["2", 
            Offset[{2, 2}, {0.03429971702850172, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{0.34299717028501764, 0.34299717028501764}, 
            0.03429971702850172], 
           InsetBox["3", 
            Offset[{2, 2}, {0.37729688731351935, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{0.6859943405700353, 0.34299717028501764}, 
            0.03429971702850172], 
           InsetBox["4", 
            Offset[{2, 2}, {0.720294057598537, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{1.028991510855053, 0.34299717028501764}, 
            0.03429971702850172], 
           InsetBox["5", 
            Offset[{2, 2}, {1.0632912278835547, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{1.3719886811400706, 0.34299717028501764}, 
            0.03429971702850172], 
           InsetBox["6", 
            Offset[{2, 2}, {1.4062883981685723, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{1.7149858514250882, 0.34299717028501764}, 
            0.03429971702850172], 
           InsetBox["7", 
            Offset[{2, 2}, {1.74928556845359, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{2.057983021710106, 0.34299717028501764}, 
            0.03429971702850172], 
           InsetBox["8", 
            Offset[{2, 2}, {2.0922827387386076, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{2.4009801919951235, 0.34299717028501764}, 
            0.03429971702850172], 
           InsetBox["9", 
            Offset[{2, 2}, {2.4352799090236252, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{2.743977362280141, 0.34299717028501764}, 
            0.03429971702850172], 
           InsetBox["10", 
            Offset[{2, 2}, {2.778277079308643, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{3.0869745325651587, 0.34299717028501764}, 
            0.03429971702850172], 
           InsetBox["11", 
            Offset[{2, 2}, {3.1212742495936605, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{3.4299717028501764, 0.34299717028501764}, 
            0.03429971702850172], 
           InsetBox["12", 
            Offset[{2, 2}, {3.464271419878678, 0.37729688731351935}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{2.743977362280141, 0.}, 0.03429971702850172], 
           InsetBox["13", 
            Offset[{2, 2}, {2.778277079308643, 0.03429971702850172}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{3.0869745325651587, 0.}, 0.03429971702850172], 
           InsetBox["14", 
            Offset[{2, 2}, {3.1212742495936605, 0.03429971702850172}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{3.4299717028501764, 0.}, 0.03429971702850172], 
           InsetBox["15", 
            Offset[{2, 2}, {3.464271419878678, 0.03429971702850172}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{3.7729688731351945, 0.}, 0.03429971702850172], 
           InsetBox["16", 
            Offset[{2, 2}, {3.8072685901636962, 0.03429971702850172}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           {RGBColor[1, 0, 0], 
            DiskBox[{4.115966043420212, 0.}, 0.03429971702850172]}, 
           InsetBox["17", 
            Offset[{2, 2}, {4.150265760448713, 0.03429971702850172}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}}}],
       MouseAppearanceTag["NetworkGraphics"]],
      AllowKernelInitialization->False]],
    DefaultBaseStyle->{
     "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
    FormatType->TraditionalForm,
    FrameTicks->None,
    ImageSize->{373., Automatic}], ",", "16"}], "]"}]], "Input",ExpressionUUID\
->"26396a7d-09f1-48be-b166-c3ca0008de49"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Automatic Export, Build and Import", "Subsection",ExpressionUUID->"44a951b9-7fee-4713-8265-378f0a6ee7c4"],

Cell[CellGroupData[{

Cell["Get CI for a Graph", "Subsubsection",ExpressionUUID->"a2924b2a-7bad-4c0f-8e52-68ded5de10dd"],

Cell[TextData[{
 "Remove the semicolon to see full analytic expression. If you give \
\[OpenCurlyDoubleQuote]p\[CloseCurlyDoubleQuote], that corresponds to giving \
CHANNELDEPOLARIZING where all the terms are equal; alternatively you can \
specify an array of four individual Pauli coefficients, e.g. ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", 
      RowBox[{"3", 
       SuperscriptBox["p", "2"]}]}], ",", 
     SuperscriptBox["p", "2"], ",", 
     SuperscriptBox["p", "2"], ",", 
     SuperscriptBox["p", "2"]}], "}"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "817d75ff-2f08-4589-8206-14877cae1374"],
 ", or use a predefined block (see section \[OpenCurlyDoubleQuote]Entropy and \
CI\[CloseCurlyDoubleQuote] above)."
}], "Text",ExpressionUUID->"a25ebd48-812d-45e6-9bf3-878900fd839b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CIMult", "@@", 
   RowBox[{"PauliActionCC", "[", 
    RowBox[{
     GraphicsBox[
      NamespaceBox["NetworkGraphics",
       DynamicModuleBox[{Typeset`graph = HoldComplete[
         Graph[{1, 2, 3, 4}, {Null, {{1, 2}, {2, 3}, {2, 4}}}, {
          FormatType -> TraditionalForm, GraphLayout -> {"Dimension" -> 2}, 
           VertexLabels -> {"Index"}, VertexSize -> {0.2}, 
           VertexStyle -> {4 -> RGBColor[1, 0, 0]}}]]}, 
        TagBox[GraphicsGroupBox[{
           {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
            {Arrowheads[0.], 
             ArrowBox[{{0., 0.}, {0.7745966692414834, 0.7745966692414834}}, 
              0.07745966692414835]}, 
            {Arrowheads[0.], 
             ArrowBox[{{0.7745966692414834, 0.7745966692414834}, {
              0.7745966692414834, 0.}}, 0.07745966692414835]}, 
            {Arrowheads[0.], 
             ArrowBox[{{0.7745966692414834, 0.7745966692414834}, {
              1.5491933384829668`, 0.}}, 0.07745966692414835]}}, 
           {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
            0.7]}], {DiskBox[{0., 0.}, 0.07745966692414835], 
             InsetBox["1", 
              Offset[{2, 2}, {0.07745966692414835, 0.07745966692414835}], 
              ImageScaled[{0, 0}],
              BaseStyle->"Graphics"]}, {
             DiskBox[{0.7745966692414834, 0.7745966692414834}, 
              0.07745966692414835], 
             InsetBox["2", 
              Offset[{2, 2}, {0.8520563361656317, 0.8520563361656317}], 
              ImageScaled[{0, 0}],
              BaseStyle->"Graphics"]}, {
             DiskBox[{0.7745966692414834, 0.}, 0.07745966692414835], 
             InsetBox["3", 
              Offset[{2, 2}, {0.8520563361656317, 0.07745966692414835}], 
              ImageScaled[{0, 0}],
              BaseStyle->"Graphics"]}, {
             {RGBColor[1, 0, 0], 
              DiskBox[{1.5491933384829668, 0.}, 0.07745966692414835]}, 
             InsetBox["4", 
              Offset[{2, 2}, {1.626653005407115, 0.07745966692414835}], 
              ImageScaled[{0, 0}],
              BaseStyle->"Graphics"]}}}],
         MouseAppearanceTag["NetworkGraphics"]],
        AllowKernelInitialization->False]],
      DefaultBaseStyle->{
       "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> 
        Hue[0.8, 1., 0.6]},
      FormatType->TraditionalForm,
      FrameTicks->None], ",", "3", ",", "p"}], "]"}]}], ";"}]], "Input",Expres\
sionUUID->"ea2e0912-4647-46ba-bfca-1cda3313ec50"],

Cell["For plotting, use e.g.", "Text",ExpressionUUID->"7ed122df-15af-4602-ad34-e6b79d1f621c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CIMult", "@@", 
   RowBox[{"PauliActionCC", "[", 
    RowBox[{
     GraphicsBox[
      NamespaceBox["NetworkGraphics",
       DynamicModuleBox[{Typeset`graph = HoldComplete[
         Graph[{1, 2, 3, 4, 5, 6, 7, 8}, {
          Null, {{1, 2}, {2, 3}, {2, 4}, {1, 5}, {5, 6}, {5, 7}, {1, 8}}}, {
          AlignmentPoint -> Center, GraphLayout -> {"Dimension" -> 2}, 
           ImageSize -> {100, 100}, VertexLabels -> {None}, 
           VertexSize -> {0.2}, VertexStyle -> {8 -> RGBColor[1, 0, 0]}}]]}, 
        TagBox[
         GraphicsGroupBox[
          GraphicsComplexBox[{{1.4819171472698969`, 1.4819171472698969`}, {
           0.3704792868174742, 0.7409585736349484}, {0., 0.}, {
           0.7409585736349484, 0.}, {1.852396434087371, 0.7409585736349484}, {
           1.4819171472698969`, 0.}, {2.2228757209048453`, 0.}, {
           2.5933550077223195`, 0.7409585736349484}}, {
            {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
             {Arrowheads[0.], ArrowBox[{1, 2}, 0.07409585736349485]}, 
             {Arrowheads[0.], ArrowBox[{1, 5}, 0.07409585736349485]}, 
             {Arrowheads[0.], ArrowBox[{1, 8}, 0.07409585736349485]}, 
             {Arrowheads[0.], ArrowBox[{2, 3}, 0.07409585736349485]}, 
             {Arrowheads[0.], ArrowBox[{2, 4}, 0.07409585736349485]}, 
             {Arrowheads[0.], ArrowBox[{5, 6}, 0.07409585736349485]}, 
             {Arrowheads[0.], ArrowBox[{5, 7}, 0.07409585736349485]}}, 
            {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
             DiskBox[1, 0.07409585736349485], DiskBox[2, 0.07409585736349485],
              DiskBox[3, 0.07409585736349485], 
             DiskBox[4, 0.07409585736349485], DiskBox[5, 0.07409585736349485],
              DiskBox[6, 0.07409585736349485], 
             DiskBox[7, 0.07409585736349485], 
             {RGBColor[1, 0, 0], DiskBox[8, 0.07409585736349485]}}}]],
         MouseAppearanceTag["NetworkGraphics"]],
        AllowKernelInitialization->False]],
      DefaultBaseStyle->{
       "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> 
        Hue[0.8, 1., 0.6]},
      FormatType->TraditionalForm,
      FrameTicks->None,
      ImageSize->{100, 100}], ",", "7", ",", "p"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "Input",
 CellLabel->"In[75]:=",ExpressionUUID->"fcbd80c3-99c7-4401-87a9-23b257e3dc6f"],

Cell["\<\
The same graph is small enough to be faster with the full solver:\
\>", "Text",ExpressionUUID->"1f99e746-31cc-4c89-9081-6924cd6c09a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CIMult", "@@", 
   RowBox[{"PauliActionCC", "[", 
    RowBox[{
     GraphicsBox[
      NamespaceBox["NetworkGraphics",
       DynamicModuleBox[{Typeset`graph = HoldComplete[
         Graph[{1, 2, 3, 4, 5, 6, 7, 8}, {
          Null, {{1, 2}, {2, 3}, {2, 4}, {1, 5}, {5, 6}, {5, 7}, {1, 8}}}, {
          AlignmentPoint -> Center, GraphLayout -> {"Dimension" -> 2}, 
           ImageSize -> {100, 100}, VertexLabels -> {None}, 
           VertexSize -> {0.2}, VertexStyle -> {8 -> RGBColor[1, 0, 0]}}]]}, 
        TagBox[
         GraphicsGroupBox[
          GraphicsComplexBox[{{1.4819171472698969`, 1.4819171472698969`}, {
           0.3704792868174742, 0.7409585736349484}, {0., 0.}, {
           0.7409585736349484, 0.}, {1.852396434087371, 0.7409585736349484}, {
           1.4819171472698969`, 0.}, {2.2228757209048453`, 0.}, {
           2.5933550077223195`, 0.7409585736349484}}, {
            {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
             {Arrowheads[0.], ArrowBox[{1, 2}, 0.07409585736349485]}, 
             {Arrowheads[0.], ArrowBox[{1, 5}, 0.07409585736349485]}, 
             {Arrowheads[0.], ArrowBox[{1, 8}, 0.07409585736349485]}, 
             {Arrowheads[0.], ArrowBox[{2, 3}, 0.07409585736349485]}, 
             {Arrowheads[0.], ArrowBox[{2, 4}, 0.07409585736349485]}, 
             {Arrowheads[0.], ArrowBox[{5, 6}, 0.07409585736349485]}, 
             {Arrowheads[0.], ArrowBox[{5, 7}, 0.07409585736349485]}}, 
            {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
             DiskBox[1, 0.07409585736349485], DiskBox[2, 0.07409585736349485],
              DiskBox[3, 0.07409585736349485], 
             DiskBox[4, 0.07409585736349485], DiskBox[5, 0.07409585736349485],
              DiskBox[6, 0.07409585736349485], 
             DiskBox[7, 0.07409585736349485], 
             {RGBColor[1, 0, 0], DiskBox[8, 0.07409585736349485]}}}]],
         MouseAppearanceTag["NetworkGraphics"]],
        AllowKernelInitialization->False]],
      DefaultBaseStyle->{
       "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> 
        Hue[0.8, 1., 0.6]},
      FormatType->TraditionalForm,
      FrameTicks->None,
      ImageSize->{100, 100}], ",", "7", ",", "p", ",", "False"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "Input",
 CellLabel->"In[77]:=",ExpressionUUID->"c28d6ba9-6624-433e-86b2-f201d42a672a"],

Cell["\<\
If the symmetry group is 0, we cannot solve with the symmetric solvers; an \
error is thrown that you can catch.\
\>", "Text",ExpressionUUID->"7cf5fa81-f7ea-4958-8ce1-36d3d969b52c"],

Cell[BoxData[
 RowBox[{"Catch", "@", 
  RowBox[{"CIThreshold", "[", 
   RowBox[{
    GraphicsBox[
     NamespaceBox["NetworkGraphics",
      DynamicModuleBox[{Typeset`graph = HoldComplete[
        Graph[{1, 2, 3, 4, 5, 6, 7}, {
         Null, {{1, 2}, {1, 3}, {2, 4}, {2, 5}, {3, 6}, {4, 7}}}, {
         GraphLayout -> {"Dimension" -> 2}, VertexLabels -> {None}, 
          VertexSize -> {0.2}, VertexStyle -> {7 -> RGBColor[1, 0, 0]}}]]}, 
       TagBox[
        GraphicsGroupBox[
         GraphicsComplexBox[{{1.1088319064318592`, 2.6611965754364624`}, {
          0.4435327625727437, 1.774131050290975}, {1.7741310502909748`, 
          1.774131050290975}, {0., 0.8870655251454875}, {0.8870655251454874, 
          0.8870655251454875}, {1.7741310502909748`, 0.8870655251454875}, {0.,
           0.}}, {
           {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
            {Arrowheads[0.], ArrowBox[{1, 2}, 0.08870655251454874]}, 
            {Arrowheads[0.], ArrowBox[{1, 3}, 0.08870655251454874]}, 
            {Arrowheads[0.], ArrowBox[{2, 4}, 0.08870655251454874]}, 
            {Arrowheads[0.], ArrowBox[{2, 5}, 0.08870655251454874]}, 
            {Arrowheads[0.], ArrowBox[{3, 6}, 0.08870655251454874]}, 
            {Arrowheads[0.], ArrowBox[{4, 7}, 0.08870655251454874]}}, 
           {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
            DiskBox[1, 0.08870655251454874], DiskBox[2, 0.08870655251454874], 
            DiskBox[3, 0.08870655251454874], DiskBox[4, 0.08870655251454874], 
            DiskBox[5, 0.08870655251454874], DiskBox[6, 0.08870655251454874], 
            {RGBColor[1, 0, 0], DiskBox[7, 0.08870655251454874]}}}]],
        MouseAppearanceTag["NetworkGraphics"]],
       AllowKernelInitialization->False]],
     DefaultBaseStyle->{
      "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
     FormatType->TraditionalForm,
     FrameTicks->None], ",", "6", ",", "p"}], "]"}]}]], "Input",
 CellLabel->"In[80]:=",ExpressionUUID->"1e4b53cc-9a60-4177-a84c-c1e902bdc915"],

Cell["Solving fully still works.", "Text",ExpressionUUID->"aed9d943-d5c0-4c05-8dad-5345670d10f5"],

Cell[BoxData[
 RowBox[{"Catch", "@", 
  RowBox[{"CIThreshold", "[", 
   RowBox[{
    GraphicsBox[
     NamespaceBox["NetworkGraphics",
      DynamicModuleBox[{Typeset`graph = HoldComplete[
        Graph[{1, 2, 3, 4, 5, 6, 7}, {
         Null, {{1, 2}, {1, 3}, {2, 4}, {2, 5}, {3, 6}, {4, 7}}}, {
         GraphLayout -> {"Dimension" -> 2}, VertexLabels -> {None}, 
          VertexSize -> {0.2}, VertexStyle -> {7 -> RGBColor[1, 0, 0]}}]]}, 
       TagBox[
        GraphicsGroupBox[
         GraphicsComplexBox[{{1.1088319064318592`, 2.6611965754364624`}, {
          0.4435327625727437, 1.774131050290975}, {1.7741310502909748`, 
          1.774131050290975}, {0., 0.8870655251454875}, {0.8870655251454874, 
          0.8870655251454875}, {1.7741310502909748`, 0.8870655251454875}, {0.,
           0.}}, {
           {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
            {Arrowheads[0.], ArrowBox[{1, 2}, 0.08870655251454874]}, 
            {Arrowheads[0.], ArrowBox[{1, 3}, 0.08870655251454874]}, 
            {Arrowheads[0.], ArrowBox[{2, 4}, 0.08870655251454874]}, 
            {Arrowheads[0.], ArrowBox[{2, 5}, 0.08870655251454874]}, 
            {Arrowheads[0.], ArrowBox[{3, 6}, 0.08870655251454874]}, 
            {Arrowheads[0.], ArrowBox[{4, 7}, 0.08870655251454874]}}, 
           {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
            DiskBox[1, 0.08870655251454874], DiskBox[2, 0.08870655251454874], 
            DiskBox[3, 0.08870655251454874], DiskBox[4, 0.08870655251454874], 
            DiskBox[5, 0.08870655251454874], DiskBox[6, 0.08870655251454874], 
            {RGBColor[1, 0, 0], DiskBox[7, 0.08870655251454874]}}}]],
        MouseAppearanceTag["NetworkGraphics"]],
       AllowKernelInitialization->False]],
     DefaultBaseStyle->{
      "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
     FormatType->TraditionalForm,
     FrameTicks->None], ",", "6", ",", "p", ",", "False"}], "]"}]}]], "Input",
 CellLabel->"In[79]:=",ExpressionUUID->"0a050135-9f0c-4186-8198-baff5db6c83d"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Optimization Runs", "Chapter",ExpressionUUID->"00a1929e-26fa-449f-842c-08f53bcad07c"],

Cell["\<\
This entire section can be safely deleted and is not necessary for the \
CoffeeCode interface. It contains some helpers for graph generation.\
\>", "Text",ExpressionUUID->"67dc0f44-4c77-40fb-95e8-6b09086d0653"],

Cell[CellGroupData[{

Cell["Rooted Graph Product/Concatenated Codes", "Subsection",ExpressionUUID->"6bcbb3e0-fa64-4848-b8e3-0798da3aa536"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ConcatGraph", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConcatGraph", "[", 
    RowBox[{
    "g1_Graph", ",", "g2_Graph", ",", "v1_Integer", ",", "v2_Integer"}], 
    "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vcount1", "=", 
        RowBox[{"VertexCount", "@", "g1"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"vertices2", "=", 
        RowBox[{"VertexList", "@", "g2"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"edges2", "=", 
        RowBox[{"EdgeList", "@", "g2"}]}]}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"vmap", "=", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#", "\[Equal]", "v2"}], ",", "v1", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", "<", "v2"}], ",", 
              RowBox[{"#", "+", "vcount1"}], ",", 
              RowBox[{"#", "+", "vcount1", "-", "1"}]}], "]"}]}], "]"}], 
          "&"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"GraphUnion", "[", 
        RowBox[{"g1", ",", 
         RowBox[{"Graph", "[", 
          RowBox[{
           RowBox[{"vmap", "/@", "vertices2"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{"vmap", ",", "edges2", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConcatGraph", "[", 
   RowBox[{"g1_Graph", ",", "g2_Graph", ",", "v1_List", ",", "v2_Integer"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Fold", "[", 
     RowBox[{"f", ",", 
      RowBox[{"{", 
       RowBox[{"g1", ",", "g2", ",", "v2"}], "}"}], ",", "v1"}], "]"}], "//.", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"gg1_", ",", "gg2_", ",", "vv2_"}], "}"}], ",", "vv1_"}], 
      "]"}], "\[RuleDelayed]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ConcatGraph", "[", 
        RowBox[{"gg1", ",", "gg2", ",", "vv1", ",", "vv2"}], "]"}], ",", 
       "gg2", ",", "vv2"}], "}"}]}]}], "//", "First"}]}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[62]:=",ExpressionUUID->"e16e1ea6-cd9b-4334-843a-35eb02a9eb61"]
}, Closed]],

Cell[CellGroupData[{

Cell["Tristar Graphs", "Section",ExpressionUUID->"e8bdafbd-d451-4eb0-a8e2-3ba44106f36e"],

Cell[CellGroupData[{

Cell["Graph Generation", "Subsection",ExpressionUUID->"bed9cacc-a5c3-4db1-bf61-1380ac4bc5e3"],

Cell["\<\
A tristar graph is like a bistar graph but with two leg bushles; there is six \
distinct choices of fitting a single hair onto it\
\>", "Text",ExpressionUUID->"1e3418e1-1c16-410d-813e-250b10f89557"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "TristarGraph", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TristarGraph", "[", 
   RowBox[{"n_", ",", "na_", ",", "nb_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nna", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"na", ",", "nb"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"nnb", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"na", ",", "nb"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "=", 
         RowBox[{"StarGraph", "[", "n", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ga", "=", 
         RowBox[{"StarGraph", "[", "nna", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"gb", "=", 
         RowBox[{"StarGraph", "[", "nnb", "]"}]}]}], "\[IndentingNewLine]", 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ConcatGraph", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ConcatGraph", "[", 
         RowBox[{"g", ",", "ga", ",", 
          RowBox[{"{", "2", "}"}], ",", "1"}], "]"}], ",", 
        "\[IndentingNewLine]", "gb", ",", 
        RowBox[{"{", "3", "}"}], ",", "1"}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "]"}]}]}], "Input",ExpressionUUID->\
"a3eeab1f-b29b-44f5-aaf9-b6c9cc4074e4"],

Cell[BoxData[{
 RowBox[{"TristarGraph", "[", 
  RowBox[{"10", ",", "5", ",", "3"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"VertexCount", "@", "%"}]}], "Input",ExpressionUUID->"6cca1a87-45d7-\
4017-86ab-c50d981da922"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EnvironmentPlot", "[", 
    RowBox[{"#", ",", 
     RowBox[{
      RowBox[{"VertexCount", "@", "#"}], "-", "1"}]}], "]"}], "&"}], "/@", 
  RowBox[{"AllHairGraphs", "[", 
   RowBox[{
    RowBox[{"TristarGraph", "[", 
     RowBox[{"10", ",", "5", ",", "3"}], "]"}], ",", 
    RowBox[{
     RowBox[{"Subsets", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", "1", "}"}]}], "]"}], "&"}]}], "]"}]}]], "Input",Expression\
UUID->"383aa1fa-9658-429a-9372-7a84996d4ff7"],

Cell["\<\
Because this is generally slow, we produce all hair codes separately as per \
below.\
\>", "Text",ExpressionUUID->"2e3855a3-20ea-430e-a80d-1673650dda15"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "AllHairGraphsTristarGraph", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllHairGraphsTristarGraph", "[", 
   RowBox[{"g_Graph", ",", 
    RowBox[{"{", 
     RowBox[{"n_Integer", ",", "na_Integer", ",", "nb_Integer"}], "}"}]}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"HairGraph", "[", 
     RowBox[{"g", ",", 
      RowBox[{"{", "#", "}"}]}], "]"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", 
     RowBox[{"n", "+", "1"}], ",", 
     RowBox[{"n", "+", 
      RowBox[{"Max", "[", 
       RowBox[{"na", ",", "nb"}], "]"}]}]}], "}"}]}]}]}], "Input",ExpressionUU\
ID->"6a6157b0-1add-4fc2-bac1-a4a32576ebb5"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "AllTristarGraphs", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AllTristarGraphs", "[", "n_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"args", "=", 
       RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"n", ",", 
           RowBox[{"{", "3", "}"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{"2", ",", "n"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "a_", ",", "b_"}], "}"}], "/;", 
          RowBox[{"a", "\[NotEqual]", "b"}]}]}], " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "delete", " ", "cases", " ", "where", " ", "two", " ", "bushles", 
           " ", "are", " ", "the", " ", "same", " ", "size", " ", "or", " ", 
           "different", " ", "size"}], ",", " ", 
          RowBox[{
           RowBox[{"these", " ", "are", " ", "two", " ", "different", " ", 
            RowBox[{"searches", ".", " ", 
             RowBox[{"It", "'"}]}], "s", " ", "easier", " ", "to", " ", "go", 
            " ", "with", " ", "the", " ", "all"}], "-", 
           RowBox[{
           "product", " ", "case", " ", "first", " ", "to", " ", "get", " ", 
            "an", " ", "intuition"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"arg", ",", "\[IndentingNewLine]", 
          RowBox[{"arg", "\[Rule]", 
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"EnvironmentPlot", "[", 
               RowBox[{"#", ",", 
                RowBox[{
                 RowBox[{"Total", "@", "arg"}], "-", "2"}]}], "]"}], "&"}], "/@", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"AllHairGraphsTristarGraph", "[", 
                 RowBox[{
                  RowBox[{"TristarGraph", "@@", "arg"}], ",", "#"}], "]"}], 
                "&"}], "@", "arg"}], "\[IndentingNewLine]", ")"}]}], 
            "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", "]"}], 
        ",", "args"}], "]"}], "//", "Association"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"AllTristarGraphs", "[", "10", "]"}]}], "Input",ExpressionUUID->\
"c52f7749-9f4c-48fd-9a79-ed5fd3892137"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exhaustive Search", "Subsection",ExpressionUUID->"4d861bb2-696f-4f3f-9919-c6858ad5207b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"searchResults", "=", 
   RowBox[{
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"AllTristarGraphs", "[", "i", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "8", ",", "63"}], "}"}]}], "]"}], "/.", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i_Integer", ",", "a_Association"}], "}"}], "\[RuleDelayed]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"results", "=", 
          RowBox[{
           RowBox[{"KeyValueMap", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"sizes", ",", "graphs"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ParallelMap", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"ci", "=", 
                    RowBox[{"Catch", "[", "\[IndentingNewLine]", 
                    RowBox[{"p", "/.", 
                    RowBox[{"CIThreshold", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"VertexCount", "@", "#"}], "-", "1"}], ",", 
                    RowBox[{"i", ">", "15"}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "stabilize", " ", "vertex", " ", "2", " ", "to", " ", 
                    "prevent", " ", 
                    RowBox[{"nauty", "'"}], "s", " ", "solver", " ", "from", 
                    " ", "being", " ", "used"}], " ", "*)"}], 
                    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\[LeftAssociation]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"\"\<sizes\>\"", "\[Rule]", "sizes"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<graph\>\"", "\[Rule]", "#"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<p\>\"", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "ci", "]"}], ",", "ci", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<error\>\"", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "ci", "]"}], ",", "False", ",", 
                    "ci"}], "]"}]}]}], "\[IndentingNewLine]", 
                    "\[RightAssociation]"}]}], "\[IndentingNewLine]", "]"}], 
                  "&"}], ",", "graphs"}], "]"}]}], "\[IndentingNewLine]", 
              "]"}], ",", "a"}], "]"}], "//", "Flatten"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"exportFilename", "=", 
          RowBox[{"RESULTSPATH", "<>", "\"\<tristar-eq.\>\"", "<>", 
           RowBox[{"ToString", "@", "i"}], "<>", "\"\<.thresholds\>\""}]}]}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Put", "[", 
         RowBox[{"results", ",", "exportFilename"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Echo", "[", 
         RowBox[{
          RowBox[{"MaximalBy", "[", 
           RowBox[{"results", ",", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "\"\<p\>\"", 
              "\[RightDoubleBracket]"}], "&"}]}], "]"}], ",", 
          RowBox[{"\"\<best for \>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}]}], ";"}]], "Input",ExpressionUUID->\
"daf236c0-b2e5-4575-959b-d3383b3893e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Visualize Results", "Subsection",ExpressionUUID->"f9403122-546d-4433-88d5-67da5b604cb2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GoodThresholdLabel", "[", "p_", "]"}], ":=", 
  RowBox[{"\[Piecewise]", GridBox[{
     {"Red", 
      RowBox[{"p", ">", "0.190356"}]},
     {"Yellow", 
      RowBox[{"p", ">", "0.19035"}]},
     {"None", "True"}
    }]}]}]], "Input",ExpressionUUID->"4ebaf6cc-65f2-43f1-b6f3-312f7edb5e38"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{"filename", ",", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"n", "=", 
            RowBox[{"Last", "@", 
             RowBox[{"StringCases", "[", 
              RowBox[{"filename", ",", 
               RowBox[{
                RowBox[{"x", ":", 
                 RowBox[{"DigitCharacter", ".."}]}], "\[RuleDelayed]", 
                RowBox[{"ToExpression", "[", "x", "]"}]}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"n", ",", "\[IndentingNewLine]", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"el", "=", 
                RowBox[{"Last", "@", 
                 RowBox[{"SortBy", "[", 
                  RowBox[{
                   RowBox[{"Get", "[", "filename", "]"}], ",", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "\"\<p\>\"", 
                    "\[RightDoubleBracket]"}], "&"}]}], "]"}]}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"p", "=", 
                  RowBox[{"el", "@", "\"\<p\>\""}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Row", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<p=\>\"", "<>", 
                    RowBox[{"ToString", "[", "p", "]"}]}], ",", 
                    RowBox[{"\"\<q=\>\"", "<>", 
                    RowBox[{"ToString", "[", "p", "]"}]}]}], "}"}], ",", 
                    "Right", ",", 
                    RowBox[{"ItemSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"6", ",", "1"}], "}"}]}], ",", 
                    RowBox[{"Background", "\[Rule]", 
                    RowBox[{"GoodThresholdLabel", "[", "p", "]"}]}]}], "]"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"Column", "[", 
                    RowBox[{"{", 
                    RowBox[{"Graph", "[", 
                    RowBox[{
                    RowBox[{"el", "@", "\"\<graph\>\""}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"350", ",", "60"}], "}"}]}]}], "]"}], "}"}], 
                    "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
               "\[IndentingNewLine]", "]"}]}], "]"}]}], "\[IndentingNewLine]",
            "}"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ",", 
      RowBox[{"FileNames", "[", 
       RowBox[{"RESULTSPATH", "<>", "\"\<tristar-eq.*.thresholds\>\""}], 
       "]"}]}], "]"}], "//", 
    RowBox[{"SortBy", "[", "First", "]"}]}], "//", "TableForm"}], "//", 
  "Rasterize"}]], "Input",ExpressionUUID->"2c4e5f4d-9a82-4052-a54d-\
4dff3867eb67"],

Cell[BoxData[
 RowBox[{"0.0635204743", "*", "3"}]], "Input",ExpressionUUID->"e1c9d2c8-2da4-4d22-b975-b307a8f6cd79"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two-Level Tree Graphs", "Section",ExpressionUUID->"d104e925-ee56-4ff2-ac3c-8aa309c9cc0c"],

Cell[CellGroupData[{

Cell["Graph Generation", "Subsection",ExpressionUUID->"3df9f9f9-da1a-4beb-9e4f-027aecb0b420"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "All2LevelGraphs", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"All2LevelGraphs", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"minChildSize_:", "2"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"partitions", "=", 
      RowBox[{"Cases", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "n"}], "}"}], ",", 
          RowBox[{"Range", "[", 
           RowBox[{"minChildSize", ",", "n"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x_", ",", "xs__"}], "}"}], "/;", 
         RowBox[{"x", "\[GreaterEqual]", 
          RowBox[{"Length", "[", 
           RowBox[{"{", "xs", "}"}], "]"}]}]}]}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"head", "=", 
           RowBox[{"StarGraph", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "@", "#"}], "+", "1"}], ",", 
             RowBox[{"VertexLabels", "\[Rule]", "\"\<Index\>\""}]}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"legs", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"StarGraph", "[", 
              RowBox[{
               RowBox[{"##", "+", "1"}], ",", 
               RowBox[{"VertexLabels", "\[Rule]", "\"\<Index\>\""}]}], "]"}], 
             "&"}], "/@", 
            RowBox[{"Rest", "@", "#"}]}]}]}], "\[IndentingNewLine]", "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"\[LeftAssociation]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<legcount\>\"", "\[Rule]", 
           RowBox[{"Length", "@", "legs"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<graph\>\"", "\[Rule]", 
            RowBox[{"Fold", "[", 
             RowBox[{"f", ",", "head", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Range", "@", 
                   RowBox[{"Length", "@", "legs"}]}], "+", "1"}], ",", 
                 "legs"}], "}"}], "\[Transpose]"}]}], "]"}]}], "//.", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"g1_Graph", ",", 
              RowBox[{"{", 
               RowBox[{"i_Integer", ",", "g2_Graph"}], "}"}]}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"ConcatGraph", "[", 
             RowBox[{"g1", ",", "g2", ",", 
              RowBox[{"{", "i", "}"}], ",", "1"}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "\[RightAssociation]"}]}], 
       "\[IndentingNewLine]", "]"}], "&"}], "/@", "partitions"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",ExpressionUUID->"b9d5a6ae-68c7-\
4fee-af5a-a508db32d00c"],

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"legcount", ",", "graphs"}], "\[IndentingNewLine]", "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"results", "=", 
           RowBox[{"MonitorParallelMap", "[", 
            RowBox[{
             RowBox[{"Apply", "@", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"legcount", ",", "graph"}], "}"}], ",", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"extraStabilizedVertices", "=", 
                    RowBox[{
                    RowBox[{"Range", "@", "legcount"}], "+", "1"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"allHairGraphs", "=", 
                    RowBox[{"AllHairGraphs", "[", 
                    RowBox[{"graph", ",", 
                    RowBox[{
                    RowBox[{"Subsets", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}], "&"}]}], "]"}]}]}], 
                   "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"ci", "=", 
                    RowBox[{"Catch", "[", "\[IndentingNewLine]", 
                    RowBox[{"p", "/.", 
                    RowBox[{"CIThreshold", "[", 
                    RowBox[{"#", ",", "kSys", ",", 
                    RowBox[{"kSys", ">", "15"}], ",", 
                    "extraStabilizedVertices"}], "]"}]}], 
                    RowBox[{"(*", " ", 
                    RowBox[{"prevent", " ", 
                    RowBox[{"nauty", "'"}], "s", " ", "solver", " ", "from", 
                    " ", "being", " ", "used"}], " ", "*)"}], 
                    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\[LeftAssociation]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"\"\<sizes\>\"", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"kSys", ",", "legcount"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<graph\>\"", "\[Rule]", 
                    RowBox[{"EnvironmentPlot", "[", 
                    RowBox[{"#", ",", "kSys"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<p\>\"", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "ci", "]"}], ",", "ci", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<error\>\"", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "ci", "]"}], ",", "False", ",", 
                    "ci"}], "]"}]}]}], "\[IndentingNewLine]", 
                    "\[RightAssociation]"}]}], "\[IndentingNewLine]", "]"}], 
                    "&"}], ",", "allHairGraphs"}], "]"}]}], 
                 "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "/@", 
                 RowBox[{"{", 
                  RowBox[{"\"\<legcount\>\"", ",", "\"\<graph\>\""}], "}"}]}],
                 ")"}], "&"}], "/@", 
              RowBox[{"All2LevelGraphs", "[", "kSys", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "1", "}"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"exportFilename", "=", 
           RowBox[{"RESULTSPATH", "<>", "\"\<2level.\>\"", "<>", 
            RowBox[{"ToString", "@", "kSys"}], "<>", 
            "\"\<.thresholds\>\""}]}]}], "\[IndentingNewLine]", "}"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Put", "[", 
          RowBox[{"results", ",", "exportFilename"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Echo", "[", 
          RowBox[{
           RowBox[{"MaximalBy", "[", 
            RowBox[{
             RowBox[{"Flatten", "@", "results"}], ",", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "\"\<p\>\"", 
               "\[RightDoubleBracket]"}], "&"}]}], "]"}], ",", 
           RowBox[{"\"\<best for \>\"", "<>", 
            RowBox[{"ToString", "[", "kSys", "]"}]}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"kSys", ",", "19", ",", "63"}], "}"}]}], "]"}]], "Input",Expressio\
nUUID->"2f151e22-ff6a-46eb-8117-548358ad1f53"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 973},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 94, 0, 98, "Title",ExpressionUUID->"05f2f0b3-248f-446b-818d-71c44321d439"],
Cell[519, 17, 196, 3, 58, "Text",ExpressionUUID->"072f76c1-fb95-4210-bd41-ba7ec3a3e0dd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[752, 25, 123, 0, 84, "Title",ExpressionUUID->"71f171ba-05e0-4ee3-a92c-268f76af182b"],
Cell[CellGroupData[{
Cell[900, 29, 183, 4, 68, "Section",ExpressionUUID->"57c69716-11b6-4909-8c06-b8034e735387"],
Cell[1086, 35, 1030, 19, 200, "Text",ExpressionUUID->"6d0b087b-bf21-4171-9beb-a1a58809c314"],
Cell[2119, 56, 234, 4, 55, "Input",ExpressionUUID->"f143b4f4-d59f-40e2-b07b-9f6d037609a9"],
Cell[2356, 62, 901, 26, 186, "Input",ExpressionUUID->"2bd927cd-d961-400d-84a7-a994bf02098a",
 InitializationCell->True],
Cell[3260, 90, 355, 9, 47, "Input",ExpressionUUID->"f4c5d28e-c768-4297-bd53-7f6008aaf1cd",
 InitializationCell->True],
Cell[3618, 101, 1729, 41, 278, "Input",ExpressionUUID->"8ac5bc65-e58d-4573-ad62-458de7d600e0",
 InitializationCell->True],
Cell[5350, 144, 125, 1, 31, "Input",ExpressionUUID->"5414ea6a-4452-4afe-accc-1ead774180cf"]
}, Closed]],
Cell[CellGroupData[{
Cell[5512, 150, 183, 3, 54, "Section",ExpressionUUID->"24de59ba-d762-45f7-a221-69fee8b0182e"],
Cell[CellGroupData[{
Cell[5720, 157, 84, 0, 55, "Subsection",ExpressionUUID->"4b3fd279-ccbd-487a-bf98-22c6f8a68bcb"],
Cell[5807, 159, 233, 5, 35, "Text",ExpressionUUID->"b1acc837-e21d-4664-ac78-39dcc027a8eb",
 InitializationCell->True],
Cell[6043, 166, 2784, 68, 216, "Input",ExpressionUUID->"131ef900-dec3-4b81-a212-609c51d8a7fe"],
Cell[8830, 236, 294, 7, 71, "Input",ExpressionUUID->"b9136ea9-e8dd-4b4d-a407-c36b6caee0e6",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[9161, 248, 98, 0, 55, "Subsection",ExpressionUUID->"adad04a3-eb52-40f0-98af-dcab146de618"],
Cell[9262, 250, 289, 4, 58, "Text",ExpressionUUID->"e09c34e0-ed88-4615-8990-033ee7fef50f"],
Cell[9554, 256, 2443, 56, 300, "Input",ExpressionUUID->"75fdcb38-966c-413a-b727-ed354caaa6f9",
 InitializationCell->True],
Cell[12000, 314, 412, 8, 31, "Input",ExpressionUUID->"172b24de-bcf5-43b8-84d5-95d7ac800159"],
Cell[12415, 324, 690, 18, 71, "Input",ExpressionUUID->"bc589834-9193-4d13-9f58-0cc97a2ae374",
 InitializationCell->True]
}, Closed]],
Cell[13120, 345, 109, 0, 39, "Subsection",ExpressionUUID->"aa5aa6ad-e4c7-4477-8c78-d8d40945c86d"],
Cell[CellGroupData[{
Cell[13254, 349, 132, 0, 39, "Subsection",ExpressionUUID->"a5a64d42-5c65-4c4f-b7a6-241f554b760b"],
Cell[13389, 351, 1578, 39, 209, "Input",ExpressionUUID->"ce1ba3f2-6195-4bf4-b2c8-dd12b0cb69ef",
 InitializationCell->True],
Cell[14970, 392, 2479, 63, 370, "Input",ExpressionUUID->"4043caca-c9e6-4af6-9a20-764068b4ae73",
 InitializationCell->True],
Cell[17452, 457, 3326, 58, 70, "Input",ExpressionUUID->"fad12075-2f16-40bd-a5f9-47919faf42f0"]
}, Closed]],
Cell[CellGroupData[{
Cell[20815, 520, 110, 0, 39, "Subsection",ExpressionUUID->"d3d25f39-62f4-4d18-9123-6a482ac8696d"],
Cell[20928, 522, 1907, 46, 232, "Input",ExpressionUUID->"7fa11aa9-bd2f-4013-a843-2475e21e26cd",
 InitializationCell->True],
Cell[22838, 570, 4926, 82, 43, "Input",ExpressionUUID->"aeaf8a1d-241e-462e-b465-e69ee74bff07"]
}, Closed]],
Cell[CellGroupData[{
Cell[27801, 657, 115, 0, 39, "Subsection",ExpressionUUID->"c27d1182-8272-4d3b-9e50-3f3eb184f12d"],
Cell[27919, 659, 1177, 29, 255, "Input",ExpressionUUID->"f38dc84c-b1bd-4f80-a420-a8f5e447a465",
 InitializationCell->True],
Cell[29099, 690, 3822, 61, 104, "Input",ExpressionUUID->"6ef330cb-fb4c-44db-8d2e-ef8efe336e57"],
Cell[32924, 753, 3095, 51, 67, "Input",ExpressionUUID->"d7d2cf99-dffb-424a-92aa-3f092a20b377"],
Cell[36022, 806, 4109, 96, 577, "Input",ExpressionUUID->"89d94e7e-a083-41fe-804e-5f69e6c36ddf",
 InitializationCell->True],
Cell[40134, 904, 12205, 239, 100, "Input",ExpressionUUID->"723d325a-6232-44cd-99cf-c4d70f0f072e"]
}, Closed]],
Cell[CellGroupData[{
Cell[52376, 1148, 111, 0, 39, "Subsection",ExpressionUUID->"07ee9774-0138-40b1-8109-cc7b2ad50df3"],
Cell[52490, 1150, 1860, 48, 255, "Input",ExpressionUUID->"b57cd762-c7e4-4f36-99e2-f7cf8ab16166",
 InitializationCell->True],
Cell[54353, 1200, 2200, 46, 82, "Input",ExpressionUUID->"e5511290-b440-4fcf-90d5-a66ddae31c59"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[56602, 1252, 167, 3, 54, "Section",ExpressionUUID->"eaeee47d-59a1-438f-8328-c2b8308da014"],
Cell[CellGroupData[{
Cell[56794, 1259, 97, 0, 55, "Subsection",ExpressionUUID->"18c6a61f-6d2d-4038-8178-0790ffc4b2d0"],
Cell[56894, 1261, 697, 17, 163, "Input",ExpressionUUID->"0b73b4fb-a095-4932-8585-2685f5888ef2",
 InitializationCell->True],
Cell[57594, 1280, 7095, 159, 922, "Input",ExpressionUUID->"0a4bcd86-0730-4679-8af5-e40188c89035",
 InitializationCell->True],
Cell[64692, 1441, 2379, 50, 59, "Input",ExpressionUUID->"13df2506-edac-4825-8123-50a2d3379f19"],
Cell[67074, 1493, 6284, 138, 1060, "Input",ExpressionUUID->"d83ed393-10ab-4d3d-92f7-a87393c5e075",
 InitializationCell->True],
Cell[73361, 1633, 2583, 50, 147, "Input",ExpressionUUID->"0b908c26-74b6-49a8-bd8c-6968c93103dd"]
}, Closed]],
Cell[CellGroupData[{
Cell[75981, 1688, 92, 0, 39, "Subsection",ExpressionUUID->"95e22c55-9322-4b85-bb76-28abbdca20b9"],
Cell[76076, 1690, 2614, 64, 508, "Input",ExpressionUUID->"9bf39e14-7948-465e-a2ae-fc0c723f51b3",
 InitializationCell->True],
Cell[78693, 1756, 139, 3, 31, "Input",ExpressionUUID->"836949d6-bd62-41ff-b96b-2b7101662f77"],
Cell[78835, 1761, 2178, 39, 115, "Input",ExpressionUUID->"b6f00e29-b817-4457-b4b7-99f87623c85f"],
Cell[81016, 1802, 1982, 48, 301, "Input",ExpressionUUID->"294c5f12-1b01-4659-b521-b6eb5e7cebd3",
 InitializationCell->True],
Cell[83001, 1852, 2211, 40, 115, "Input",ExpressionUUID->"57e342af-dc52-449e-8eab-3f6e3001876f"]
}, Closed]],
Cell[CellGroupData[{
Cell[85249, 1897, 98, 0, 39, "Subsection",ExpressionUUID->"17756b3f-3473-48b9-9981-e5202fb0b160"],
Cell[85350, 1899, 3028, 70, 554, "Input",ExpressionUUID->"60cf9552-f3ec-4557-9d53-682c589fa289",
 InitializationCell->True],
Cell[88381, 1971, 1951, 35, 123, "Input",ExpressionUUID->"edd014c9-3edf-427c-a5ed-408fc1410676"]
}, Closed]],
Cell[CellGroupData[{
Cell[90369, 2011, 98, 0, 39, "Subsection",ExpressionUUID->"78bfb35b-a715-4258-8cfb-ccbe9554565e"],
Cell[90470, 2013, 1631, 44, 196, "Input",ExpressionUUID->"0d05934d-de45-4e75-9c77-711a417d82bc",
 InitializationCell->True],
Cell[92104, 2059, 642, 19, 31, "Input",ExpressionUUID->"97ebc215-ee1e-45e4-8c7d-98dd97a449fa"],
Cell[92749, 2080, 5360, 129, 875, "Input",ExpressionUUID->"08fb50c6-fd2a-426d-8f7c-650956d551e4",
 InitializationCell->True],
Cell[98112, 2211, 3653, 72, 75, "Input",ExpressionUUID->"13a101ed-0cfc-4c0d-82fa-7922bfd0149f"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[101814, 2289, 88, 0, 58, "Chapter",ExpressionUUID->"6c8e77dd-fd20-4053-b686-04d3c83d53ea"],
Cell[CellGroupData[{
Cell[101927, 2293, 88, 0, 68, "Section",ExpressionUUID->"7cd42527-551f-4535-83c6-808d349bf01b"],
Cell[102018, 2295, 960, 28, 120, "Input",ExpressionUUID->"b6ce4992-8a66-4686-bc96-b6076a8d7d08",
 InitializationCell->True],
Cell[102981, 2325, 1172, 32, 94, "Input",ExpressionUUID->"f4608d96-84ba-4733-976d-4ec7f1fb79a1",
 InitializationCell->True],
Cell[104156, 2359, 1114, 27, 163, "Input",ExpressionUUID->"fe05033a-e239-4efe-a1df-40b15440c395",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[105307, 2391, 92, 0, 68, "Section",ExpressionUUID->"189f46b1-436d-45bd-b989-38c322e68899"],
Cell[CellGroupData[{
Cell[105424, 2395, 90, 0, 55, "Subsection",ExpressionUUID->"ed233b51-7d25-4213-826c-5184a50d3c84"],
Cell[CellGroupData[{
Cell[105539, 2399, 101, 0, 45, "Subsubsection",ExpressionUUID->"23cddb85-a632-422c-a677-2ccbd4a7869b"],
Cell[105643, 2401, 129, 0, 35, "Text",ExpressionUUID->"87db0a61-0fe8-4c97-b6e8-576611de5095"],
Cell[105775, 2403, 175, 2, 78, "Input",ExpressionUUID->"5ff3cb61-7f74-42c0-851a-e975fca6b095"],
Cell[105953, 2407, 172, 3, 35, "Text",ExpressionUUID->"6548b310-e0f8-4ad8-b628-8547e7ec7bbe"],
Cell[106128, 2412, 346, 8, 31, "Input",ExpressionUUID->"d4f14064-833b-4ef1-b295-3a6f2fee498f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106511, 2425, 124, 0, 45, "Subsubsection",ExpressionUUID->"d290f4db-2fe0-4f9a-bfda-df84839cf46b"],
Cell[106638, 2427, 422, 11, 78, "Input",ExpressionUUID->"afdaf128-eb5b-47de-a0e9-2ede66743e42"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107097, 2443, 95, 0, 45, "Subsubsection",ExpressionUUID->"eb69490e-e745-4f7d-ab7f-3f296d527b40"],
Cell[107195, 2445, 108, 0, 35, "Text",ExpressionUUID->"5df465c7-68b8-4b7c-9d67-ac4c0479e2d6"],
Cell[107306, 2447, 2280, 48, 75, "Input",ExpressionUUID->"d8b9781b-be39-4820-8ed8-60df8fd4afd3"],
Cell[109589, 2497, 95, 0, 35, "Text",ExpressionUUID->"8c35da14-2d2b-43d0-abff-1f0017a599b2"],
Cell[109687, 2499, 8324, 175, 100, "Input",ExpressionUUID->"26396a7d-09f1-48be-b166-c3ca0008de49"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[118060, 2680, 111, 0, 39, "Subsection",ExpressionUUID->"44a951b9-7fee-4713-8265-378f0a6ee7c4"],
Cell[CellGroupData[{
Cell[118196, 2684, 98, 0, 45, "Subsubsection",ExpressionUUID->"a2924b2a-7bad-4c0f-8e52-68ded5de10dd"],
Cell[118297, 2686, 854, 19, 61, "Text",ExpressionUUID->"a25ebd48-812d-45e6-9bf3-878900fd839b"],
Cell[119154, 2707, 2507, 53, 75, "Input",ExpressionUUID->"ea2e0912-4647-46ba-bfca-1cda3313ec50"],
Cell[121664, 2762, 93, 0, 35, "Text",ExpressionUUID->"7ed122df-15af-4602-ad34-e6b79d1f621c"],
Cell[121760, 2764, 2485, 48, 148, "Input",ExpressionUUID->"fcbd80c3-99c7-4401-87a9-23b257e3dc6f"],
Cell[124248, 2814, 144, 2, 35, "Text",ExpressionUUID->"1f99e746-31cc-4c89-9081-6924cd6c09a7"],
Cell[124395, 2818, 2499, 48, 148, "Input",ExpressionUUID->"c28d6ba9-6624-433e-86b2-f201d42a672a"],
Cell[126897, 2868, 191, 3, 35, "Text",ExpressionUUID->"7cf5fa81-f7ea-4958-8ce1-36d3d969b52c"],
Cell[127091, 2873, 2028, 36, 123, "Input",ExpressionUUID->"1e4b53cc-9a60-4177-a84c-c1e902bdc915"],
Cell[129122, 2911, 97, 0, 35, "Text",ExpressionUUID->"aed9d943-d5c0-4c05-8dad-5345670d10f5"],
Cell[129222, 2913, 2042, 36, 123, "Input",ExpressionUUID->"0a050135-9f0c-4186-8198-baff5db6c83d"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[131337, 2957, 91, 0, 69, "Chapter",ExpressionUUID->"00a1929e-26fa-449f-842c-08f53bcad07c"],
Cell[131431, 2959, 220, 3, 35, "Text",ExpressionUUID->"67dc0f44-4c77-40fb-95e8-6b09086d0653"],
Cell[CellGroupData[{
Cell[131676, 2966, 116, 0, 55, "Subsection",ExpressionUUID->"6bcbb3e0-fa64-4848-b8e3-0798da3aa536"],
Cell[131795, 2968, 2511, 65, 370, "Input",ExpressionUUID->"e16e1ea6-cd9b-4334-843a-35eb02a9eb61",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[134343, 3038, 88, 0, 54, "Section",ExpressionUUID->"e8bdafbd-d451-4eb0-a8e2-3ba44106f36e"],
Cell[CellGroupData[{
Cell[134456, 3042, 93, 0, 55, "Subsection",ExpressionUUID->"bed9cacc-a5c3-4db1-bf61-1380ac4bc5e3"],
Cell[134552, 3044, 208, 3, 35, "Text",ExpressionUUID->"1e3418e1-1c16-410d-813e-250b10f89557"],
Cell[134763, 3049, 1495, 35, 377, "Input",ExpressionUUID->"a3eeab1f-b29b-44f5-aaf9-b6c9cc4074e4"],
Cell[136261, 3086, 218, 4, 55, "Input",ExpressionUUID->"6cca1a87-45d7-4017-86ab-c50d981da922"],
Cell[136482, 3092, 510, 15, 31, "Input",ExpressionUUID->"383aa1fa-9658-429a-9372-7a84996d4ff7"],
Cell[136995, 3109, 163, 3, 35, "Text",ExpressionUUID->"2e3855a3-20ea-430e-a80d-1673650dda15"],
Cell[137161, 3114, 707, 20, 55, "Input",ExpressionUUID->"6a6157b0-1add-4fc2-bac1-a4a32576ebb5"],
Cell[137871, 3136, 2669, 60, 423, "Input",ExpressionUUID->"c52f7749-9f4c-48fd-9a79-ed5fd3892137"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140577, 3201, 94, 0, 55, "Subsection",ExpressionUUID->"4d861bb2-696f-4f3f-9919-c6858ad5207b"],
Cell[140674, 3203, 3993, 89, 469, "Input",ExpressionUUID->"daf236c0-b2e5-4575-959b-d3383b3893e9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144704, 3297, 94, 0, 55, "Subsection",ExpressionUUID->"f9403122-546d-4433-88d5-67da5b604cb2"],
Cell[144801, 3299, 323, 9, 64, "Input",ExpressionUUID->"4ebaf6cc-65f2-43f1-b6f3-312f7edb5e38"],
Cell[145127, 3310, 3221, 74, 308, "Input",ExpressionUUID->"2c4e5f4d-9a82-4052-a54d-4dff3867eb67"],
Cell[148351, 3386, 115, 1, 31, "Input",ExpressionUUID->"e1c9d2c8-2da4-4d22-b975-b307a8f6cd79"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[148515, 3393, 95, 0, 68, "Section",ExpressionUUID->"d104e925-ee56-4ff2-ac3c-8aa309c9cc0c"],
Cell[CellGroupData[{
Cell[148635, 3397, 93, 0, 55, "Subsection",ExpressionUUID->"3df9f9f9-da1a-4beb-9e4f-027aecb0b420"],
Cell[148731, 3399, 3083, 77, 400, "Input",ExpressionUUID->"b9d5a6ae-68c7-4fee-af5a-a508db32d00c"],
Cell[151817, 3478, 5345, 115, 791, "Input",ExpressionUUID->"2f151e22-ff6a-46eb-8117-548358ad1f53"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

